(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{0:function(e,n,t){t("55Il"),t("p2bk"),e.exports=t("7RL8")},1:function(e,n){},2:function(e,n){},3:function(e,n){},"7RL8":function(e,n,t){"use strict";t.r(n);var o=t("YHGo"),r=t("q1tI"),m=t.n(r),a=t("i8i4"),i=t("ANjH"),c=t("Igns"),u=t("/MKj"),l=t("gyEF"),s=t.n(l),d=t("aJ4A"),p=t("sINF"),f=t("N2Rb"),h="DIALOG/SHOW",g="DIALOG/HIDE",y="ORG/FETCH_FULFILLED",v="ORG/FETCH_USERS_FULFILLED",b="ORG/RESOLVE_REQUEST_FULFILLED",w="ORG/RESET",E="ROOM/ADD_PHOTO",O="ROOM/JOIN",R="ROOM/PEER_JOIN",S="ROOM/PEER_LEAVE",k="ROOM/PEER_POINTER",_="ROOM/PEER_SIGNAL",j="ROOM/PEER_STREAM",I="ROOM/MOVE_PHOTO",T="ROOM/REMOVE_PHOTO",P="ROOM/RESET",C="USER/REFRESH_SESSION_FULFILLED",x="USER/REFRESH_SESSION_REJECTED",A="USER/SAVE_SETTINGS",q="USER/SIGNOUT",L="USER/START_STREAM",M="USER/TOGGLE_AUDIO";function N(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var U=new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseURL="https://api.babelchat.tk/"}var n,t,o;return n=e,(t=[{key:"fetch",value:function(n){function e(e){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(e){var n=e.body,t=e.endpoint,o=e.headers,a=void 0===o?{}:o,r=e.method,i=void 0===r?"GET":r,c=this.authorization,u=this.baseURL;return c&&(a.Authorization=c),!n||n instanceof FormData||(n=JSON.stringify(n),a["Content-Type"]="application/json"),fetch("".concat(u).concat(t),{body:n,headers:a,method:i}).then(function(e){var n=e.headers,t=e.status;if(t<200||400<=t)throw new Error(t);switch((n.get("Content-Type")||"").split(";")[0]){case"text/plain":return e.arrayBuffer();case"application/json":return e.json();default:return e}})})},{key:"setAuthorization",value:function(e){e?this.authorization="Bearer ".concat(e):delete this.authorization,this.token=e}}])&&N(n.prototype,t),o&&N(n,o),e}());function D(e){return e?{type:C,payload:e}:function(e){return e({type:"USER/REFRESH_SESSION",payload:U.fetch({endpoint:"user"})}).catch(function(){})}}t("bo1M");var z=t("wcCE");var G={en:{NotFound:{description:"This is not the web page you're looking for.",goBack:"Take me back home"},Org:{CreateRoom:{title:"Create a room",flag:"Flag",name:"Name",peerLimit:"Peer limit",submit:"Create room"},CTA:{copy:"Are you an academy manager/teacher?",button:"Try it now"},ManageUsers:{title:"Manage students",approve:"Approve",decline:"Decline"},Nav:{createRoom:"Create room",customize:"Customize",manageUsers:"Manage students"},Signup:{title:"Create an account",name:"Organization name",submit:"Create account"}},Room:{joining:"Joining room...",welcome:'Welcome to: "%{name}"'},Rooms:{peers:"%{count}/%{limit} peers"},User:{Settings:{title:"Settings",audioInput:"Audio input",save:"Save settings",signIn:"Sign-In with google",videoInput:"Video input"}}},es:{NotFound:{description:"Esta no es la página que estás buscando.",goBack:"Volver al inicio"},Org:{CreateRoom:{title:"Crear una sala",flag:"Bandera",name:"Nombre",peerLimit:"Límite de parcipantes",submit:"Crear sala"},CTA:{copy:"Eres gestor(a)/profesor(a) de una academia?",button:"Pruébalo ahora"},ManageUsers:{title:"Estudiantes",approve:"Aprobar",decline:"Rechazar"},Nav:{createRoom:"Crear sala",customize:"Personalizar",manageUsers:"Estudiantes"},Signup:{title:"Crear una cuenta",name:"Nombre de la organización",submit:"Crear cuenta"}},Room:{joining:"Entrando en la sala...",welcome:'Bienvenido a: "%{name}"'},Rooms:{peers:"%{count}/%{limit} personas"},User:{Settings:{title:"Preferencias",audioInput:"Entrada de audio",save:"Guardar preferencias",signIn:"Iniciar Sesión con google",videoInput:"Entrada de vídeo"}}}},F=Object.keys(G),B={};F.forEach(function(e){B[e]=Object(z.recursive)(!0,G.en,G[e])});function W(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(e){H(n,e,t[e])})}return n}function H(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function V(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var J=Object(i.c)({hasLoaded:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case y:return!0;case w:return!1;default:return e}},id:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case y:return n.payload._id;case w:return"";default:return e}},isActive:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case y:return n.payload.isActive||!1;case w:return!1;default:return e}},isAdmin:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case y:return n.payload.isAdmin||!1;case w:return!1;default:return e}},isUser:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case y:return n.payload.isUser||!1;case"ORG/REQUEST_ACCESS_FULFILLED":return!0;case w:return!1;default:return e}},name:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case y:return n.payload.name;case w:return"";default:return e}},pendingRequests:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length?arguments[1]:void 0;switch(n.type){case v:return n.payload.reduce(function(e,n){return e+(n.isRequest?1:0)},0);case b:return e-1;case w:return 0;default:return e}},rooms:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"ORG/FETCH_ROOMS_FULFILLED":return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case"ORG/CREATE_ROOM_FULFILLED":return[].concat(V(e),[n.payload]).sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case"ORG/REMOVE_ROOM_FULFILLED":return e.filter(function(e){return e.slug!==n.payload.slug});case w:return[];default:return e}},users:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case v:return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case"ORG/REMOVE_USER_FULFILLED":return e.filter(function(e){return e._id!==n.payload.user});case b:return"approve"===n.payload.resolution?e.map(function(e){return e._id===n.payload.user?function(a){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){var n,t,o;n=a,o=r[t=e],t in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o})}return a}({},e,{isRequest:void 0}):e}):e.filter(function(e){return e._id!==n.payload.user});case w:return[];default:return e}}}),K=t("1339"),Y=t.n(K);function Q(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var X=(new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.promises=[],this.getPromise=this.getPromise.bind(this),this.onKey=this.onKey.bind(this),this.onPointer=this.onPointer.bind(this),this.touches=Y()(window,{filtered:!0,preventSimulated:!1}).on("start",this.onPointer).on("end",this.onPointer),window.addEventListener("keydown",this.onKey,!1),window.addEventListener("keyup",this.onKey,!1)}var n,t,o;return n=e,(t=[{key:"getPromise",value:function(){var n=this.isReady,t=this.promises;return new Promise(function(e){n?e():t.push(e)})}},{key:"onFirstInteraction",value:function(){var e=this.promises;this.touches.disable(),window.removeEventListener("keydown",this.onKey),window.removeEventListener("keyup",this.onKey),this.isReady=!0,e.forEach(function(e){return e()})}},{key:"onKey",value:function(){this.onFirstInteraction()}},{key:"onPointer",value:function(){this.onFirstInteraction()}}])&&Q(n.prototype,t),o&&Q(n,o),e}())).getPromise;function Z(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(e){$(n,e,t[e])})}return n}function $(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ee(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ne=Object(i.c)({name:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case O:return n.payload.name;case P:return"";default:return e}},peers:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0;switch(t.type){case O:return e.forEach(function(e){return e.connection.destroy()}),t.payload.peers;case R:return[].concat(ee(e),[t.payload.peer]);case S:return e.filter(function(e){var n=e.connection;return e.peer===t.payload.peer&&(n.destroy(),!0)});case k:return e.map(function(e){return e.peer===t.payload.peer?Z({},e,{pointer:t.payload.pointer}):e});case _:return e.forEach(function(e){var n=e.connection;e.peer===t.payload.peer&&n.signal(t.payload.signal)}),e;case j:return e.map(function(e){if(e.peer!==t.payload.peer)return e;var n=document.createElement("video");return n.srcObject=t.payload.stream,n.onloadedmetadata=function(){return X().then(function(){return n.play()})},Z({},e,{video:n})});case L:return e.forEach(function(e){e.connection.addStream(t.payload.stream)}),e;case P:return e.forEach(function(e){return e.connection.destroy()}),[];default:return e}},photos:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case O:return n.payload.photos;case E:return[].concat(ee(e),[n.payload]);case I:return e.map(function(e){return e._id===n.payload.photo?Z({},e,{origin:{x:n.payload.origin.x,y:n.payload.origin.y}}):e});case T:return e.filter(function(e){return e._id!==n.payload.photo});case P:return[];default:return e}},socket:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case O:return n.payload.socket;case P:return!1;default:return e}}}),te="BABELCHAT::",oe="".concat(te,"SESSION"),ae=JSON.parse(localStorage.getItem(oe)||"false");ae&&U.setAuthorization(ae.token);var re=Object(i.c)({isAudioMuted:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case M:return!e;default:return e}},isAuth:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!!ae;switch((1<arguments.length?arguments[1]:void 0).type){case C:return!0;case x:case q:return!1;default:return e}},orgs:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"USER/FETCH_ORGS_FULFILLED":return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case q:return[];default:return e}},profile:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ae?ae.profile:{},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case C:return n.payload.profile;case x:case q:return{};default:return e}},settings:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{audioInput:localStorage.getItem("".concat(te,"audioInput"))||"",videoInput:localStorage.getItem("".concat(te,"videoInput"))||""},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case A:var t=n.payload,o=t.audioInput,a=t.videoInput;return localStorage.setItem("".concat(te,"audioInput"),o||""),localStorage.setItem("".concat(te,"videoInput"),a||""),{audioInput:o,videoInput:a};default:return e}},stream:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case L:return n.payload.stream;case P:return e&&e.getTracks().forEach(function(e){return e.stop()}),!1;case M:return e&&e.getAudioTracks().forEach(function(e){e.enabled=!e.enabled}),e;default:return e}},token:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ae?ae.token:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case C:return U.setAuthorization(n.payload.token),localStorage.setItem(oe,JSON.stringify(n.payload)),n.payload.token;case x:case q:return U.setAuthorization(!1),localStorage.removeItem(oe),"";default:return e}},video:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case L:var t=document.createElement("video");return t.muted=!0,t.srcObject=n.payload.stream,t.onloadedmetadata=function(){return X().then(function(){return t.play()})},t;case P:return e&&(e.srcObject=null),!1;default:return e}}}),ie=Object(i.c)({dialog:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case h:return W({},e,H({},n.payload.id,!0));case g:return W({},e,H({},n.payload.id,!1));default:return e}},i18n:f.i18nReducer,loadingBar:l.loadingBarReducer,org:J,room:ne,user:re}),ce=t("2INN"),ue=t("mf+E"),le=t("jKe7"),se=t("17x9"),de=t.n(se),pe=t("vOnD"),me=t("O1PE");function fe(e){return{type:g,payload:{id:e}}}function he(e){return{type:h,payload:{id:e}}}function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ve(e,n){return!n||"object"!==ge(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,n){return(we=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Ee=function(e){function t(e){var n;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ve(this,be(t).call(this,e))).dom=m.a.createRef(),n}var n,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&we(e,n)}(t,r["Component"]),n=t,(o=[{key:"componentDidMount",value:function(){var e=this.dom,n=this.props.video;e.current.appendChild(n)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.dom;return m.a.createElement("div",{ref:e})}}])&&ye(n.prototype,o),a&&ye(n,a),t}();Ee.propTypes={video:de.a.object.isRequired};var Oe=Ee,Re=pe.a.button.withConfig({displayName:"button",componentId:"sc-182fno4-0"})(["display:flex;align-items:center;justify-content:center;padding:0.5rem 1rem;margin:0;background-color:",";color:#eee;border:1px solid #151515;border-radius:2px;outline:0;font-family:inherit;font-size:inherit;font-weight:700;transition:background-color ease-out .2s;will-change:background-color;cursor:pointer;> span{margin-left:0.5rem;}&:hover{background-color:#393;}"],function(e){return e.primary?"#393":"#111"}),Se=pe.a.div.withConfig({displayName:"dialog__Overlay",componentId:"r5l1bo-0"})(["position:fixed;top:0;left:0;bottom:0;width:100%;background:rgba(0,0,0,.75);z-index:100000;"]),ke=pe.a.div.withConfig({displayName:"dialog__Wrapper",componentId:"r5l1bo-1"})(["position:absolute;top:50%;left:50%;transform:translate(-50%,-75%);width:",";display:flex;flex-direction:column;border-radius:2px;"],function(e){return e.width}),_e=pe.a.h2.withConfig({displayName:"dialog__Heading",componentId:"r5l1bo-2"})(["flex-shrink:0;display:flex;justify-content:space-between;align-items:center;height:40px;margin:0;font-size:1.25em;padding:0 1rem;background:#393;color:#eee;border-radius:2px 2px 0 0;> a{display:flex;text-decoration:none;font-size:1.5em;cursor:pointer;}"]),je=pe.a.div.withConfig({displayName:"dialog__Content",componentId:"r5l1bo-3"})(["padding:1rem;background:#eee;color:#353535;border-radius:0 0 2px 2px;"]),Ie=function(e){var n=e.children,t=e.id,o=e.isShowing,a=e.title,r=e.width,i=e.hide;return o?m.a.createElement(Se,null,m.a.createElement(ke,{width:r||"400px"},m.a.createElement(_e,null,m.a.createElement(f.Translate,{value:a||"".concat(t,".title")}),m.a.createElement("a",{onClick:function(){return i(t)}},m.a.createElement(me.TiTimes,null))),m.a.createElement(je,null,n))):null};Ie.defaultProps={title:void 0,width:void 0},Ie.propTypes={children:de.a.node.isRequired,id:de.a.string.isRequired,isShowing:de.a.bool.isRequired,title:de.a.string,width:de.a.string,hide:de.a.func.isRequired};var Te=Object(u.connect)(function(e,n){return{isShowing:e.dialog[n.id]||!1}},{hide:fe})(Ie),Pe=pe.a.form.withConfig({displayName:"form",componentId:"sc-1i7o20f-0"})(["> div{margin-top:0.5rem;text-align:left;&:first-child{margin-top:0;}> label{display:block;width:100%;font-weight:700;}> input,> select{display:block;font-family:inherit;box-sizing:border-box;width:100%;padding:0.5rem;cursor:pointer;border:1px solid #ccc;}> button{margin:1rem auto;padding:0.5rem 1rem;cursor:pointer;}}"]);function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(e,n){return(Le=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Me=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Ae(a).call(this,e))||"object"!==Ce(o)&&"function"!=typeof o?qe(t):o).onSubmit=n.onSubmit.bind(qe(n)),n.state={},n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Le(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentDidMount",value:function(){var o=this;navigator.mediaDevices.enumerateDevices().then(function(e){var n=e.filter(function(e){return"audioinput"===e.kind}),t=e.filter(function(e){return"videoinput"===e.kind});o.setState({audioInputs:n,videoInputs:t})}).catch(function(){})}},{key:"onSubmit",value:function(e){var n=this.props,t=n.hide,o=n.isStreaming,a=n.save;e.preventDefault();var r=e.target;a({audioInput:r.audioInput.value,videoInput:r.videoInput.value}),t("User.Settings"),o&&window.location.reload()}},{key:"render",value:function(){var e=this.props.settings,n=e.audioInput,t=e.videoInput,o=this.state,a=o.audioInputs,r=o.videoInputs;return a&&r?m.a.createElement(Te,{id:"User.Settings"},m.a.createElement(Pe,{onSubmit:this.onSubmit},m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"User.Settings.audioInput"})),m.a.createElement("select",{name:"audioInput",defaultValue:n},a.map(function(e){var n=e.deviceId,t=e.label;return m.a.createElement("option",{key:n,value:n},t)}))),m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"User.Settings.videoInput"})),m.a.createElement("select",{name:"videoInput",defaultValue:t},r.map(function(e){var n=e.deviceId,t=e.label;return m.a.createElement("option",{key:n,value:n},t)}))),m.a.createElement("div",{className:"submit"},m.a.createElement(Re,{type:"submit"},m.a.createElement(me.TiTick,null),m.a.createElement(f.Translate,{value:"User.Settings.save"}))))):null}}])&&xe(n.prototype,t),o&&xe(n,o),a}();Me.propTypes={isStreaming:de.a.bool.isRequired,settings:de.a.shape({audioInput:de.a.string.isRequired,videoInput:de.a.string.isRequired}).isRequired,hide:de.a.func.isRequired,save:de.a.func.isRequired};var Ne=Object(u.connect)(function(e){var n=e.user,t=n.settings;return{isStreaming:!!n.stream,settings:t}},{hide:fe,save:function(e){var n=e.audioInput,t=e.videoInput;return{type:A,payload:{audioInput:n,videoInput:t}}}})(Me),Ue=pe.a.div.withConfig({displayName:"user__Wrapper",componentId:"wx5awn-0"})(["position:absolute;top:0;right:0;background:#000;box-shadow:0 0 10px rgba(0,0,0,.5);overflow:hidden;&,> img,> div > video{width:100px;height:100px;}> img{vertical-align:middle;}.actions{display:flex;position:absolute;bottom:-100%;width:100%;align-items:center;justify-content:space-between;font-size:2em;color:#eee;transition:bottom ease-out .2s;will-change:bottom;> a{cursor:pointer;&:hover{background:#eee;color:#333;}}}&:hover .actions{bottom:0;}"]),De=function(e){var n=e.isAudioMuted,t=e.isAuth,o=e.profile,a=e.video,r=e.showDialog,i=e.signout,c=e.toggleAudio;return t?m.a.createElement("div",null,m.a.createElement(Ue,null,a&&a.srcObject.getVideoTracks().length?m.a.createElement(Oe,{video:a}):m.a.createElement("img",{src:"".concat(U.baseURL,"user/").concat(o._id,"/photo?auth=").concat(U.token)}),m.a.createElement("div",{className:"actions"},m.a.createElement("a",{onClick:c},n?m.a.createElement(me.TiVolumeMute,null):m.a.createElement(me.TiVolumeDown,null)),m.a.createElement("a",{onClick:function(){return r("User.Settings")}},m.a.createElement(me.TiCog,null)),m.a.createElement("a",{onClick:i},m.a.createElement(me.TiEject,null)))),m.a.createElement(Ne,null)):null};De.propTypes={isAudioMuted:de.a.bool.isRequired,isAuth:de.a.bool.isRequired,profile:de.a.shape({_id:de.a.string}).isRequired,video:de.a.oneOfType([de.a.bool,de.a.object]).isRequired,showDialog:de.a.func.isRequired,signout:de.a.func.isRequired,toggleAudio:de.a.func.isRequired};var ze=Object(u.connect)(function(e){var n=e.user;return{isAudioMuted:n.isAudioMuted,isAuth:n.isAuth,profile:n.profile,video:n.video}},{showDialog:he,signout:function(){return{type:q}},toggleAudio:function(){return{type:M}}})(De),Ge=pe.a.div.withConfig({displayName:"layout__Route",componentId:"wopef3-0"})(["display:flex;height:100vh;"]),Fe={backgroundColor:"#393",zIndex:1},Be=function(e){var n=e.children;return m.a.createElement("div",null,m.a.createElement(s.a,{style:Fe}),m.a.createElement(Ge,null,n),m.a.createElement(ze,null))};Be.propTypes={children:de.a.node.isRequired};var We=Be,He=t("2iEm");function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qe(e,n){return(Qe=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Xe=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Ke(a).call(this,e))||"object"!==Ve(o)&&"function"!=typeof o?Ye(t):o).loginWithGoogle=n.loginWithGoogle.bind(Ye(n)),n.onMessage=n.onMessage.bind(Ye(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Qe(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentWillUnmount",value:function(){var e=this.popupWatcher;e&&(window.removeEventListener("message",this.onMessage),clearInterval(e),delete this.popupWatcher)}},{key:"onMessage",value:function(e){var n=e.origin,t=e.data.session,o=this.popupWatcher,a=this.props,r=a.onSession,i=a.refreshSession;0===U.baseURL.indexOf(n)&&(window.removeEventListener("message",this.onMessage),clearInterval(o),delete this.popupWatcher,t&&(i(t),r&&r(t)))}},{key:"loginWithGoogle",value:function(e){var n=this,t=e.screenX,o=e.screenY,a=(t||window.screen.width/2)-256,r=(o||window.screen.height/2)-256,i=window.open("".concat(U.baseURL,"user/google"),"loginWithGoogle","width=".concat(512,",height=").concat(512,",top=").concat(r,",left=").concat(a));this.popupWatcher&&(window.removeEventListener("message",this.onMessage),clearInterval(this.popupWatcher)),this.popupWatcher=setInterval(function(){if(!i.window)return clearInterval(n.popupWatcher),void delete n.popupWatcher;i.postMessage(!0,U.baseURL)},100),window.addEventListener("message",this.onMessage,!1)}},{key:"render",value:function(){var e=this.props,n=e.icon,t=e.label;return m.a.createElement(Re,{type:"button",onClick:this.loginWithGoogle},m.a.createElement(n,null),m.a.createElement(f.Translate,{value:t}))}}])&&Je(n.prototype,t),o&&Je(n,o),a}();Xe.defaultProps={icon:me.TiSocialGooglePlus,label:"User.signIn",onSession:void 0},Xe.propTypes={icon:de.a.func,label:de.a.string,onSession:de.a.func,refreshSession:de.a.func.isRequired};var Ze=Object(u.connect)(function(){return{}},{refreshSession:D})(Xe),$e=pe.a.div.withConfig({displayName:"page__Scroll",componentId:"sc-2p96wn-0"})(["display:flex;width:100%;overflow-y:overlay;"]),en=pe.a.div.withConfig({displayName:"page__Wrapper",componentId:"sc-2p96wn-1"})(["display:flex;width:100%;max-width:1024px;flex-direction:column;background:#fff;margin:0 auto;box-shadow:0 0 150px rgba(0,0,0,.15);"]),nn=function(e){var n=e.children,t=e.className;return m.a.createElement($e,null,m.a.createElement(en,{className:t},n))};nn.defaultProps={className:null},nn.propTypes={children:de.a.oneOfType([de.a.element,de.a.arrayOf(de.a.element)]).isRequired,className:de.a.string};var tn=nn;function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e,n){return(un=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var ln=pe.a.div.withConfig({displayName:"landing__Heading",componentId:"sc-8xfovt-0"})(["display:flex;flex-shrink:0;flex-direction:column;align-items:center;justify-content:center;background:#222;height:300px;> h2{color:#fff;font-size:3em;margin:0 0 1.5rem;}> p{color:#eee;margin:0;font-size:1.5em;}"]),sn=pe.a.div.withConfig({displayName:"landing__Grid",componentId:"sc-8xfovt-1"})(["display:flex;height:100%;> div,> ul{&:nth-child(1){width:60%;}&:nth-child(2){width:40%;}}"]),dn=pe.a.div.withConfig({displayName:"landing__Orgs",componentId:"sc-8xfovt-2"})(["background:#eee;> h3{margin:0;font-size:1.5em;color:#666;padding:1.5rem 1.5rem 1rem;border-bottom:1px solid #ddd;}> a{display:flex;box-sizing:border-box;width:100%;align-items:center;justify-content:space-between;font-size:1.5em;padding:0.75rem 1.5rem;color:#000;text-decoration:none;transition:color ease-out .15s,background-color ease-out .15s;will-change:color,background-color;&:nth-child(odd){background:#ddd;}&.full{opacity:0.5;pointer-events:none;}> strong > img{width:1.5rem;height:1.125rem;margin-right:1rem;vertical-align:middle;}&:hover{color:#eee;background-color:#393;}}> button{margin:1.5rem auto;> svg{font-size:2em;}}"]),pn=pe.a.ul.withConfig({displayName:"landing__Features",componentId:"sc-8xfovt-3"})(["margin:2rem 1rem;text-align:left;> li{padding:0.5rem 0.5rem;font-size:1.5em;}"]),mn=pe.a.div.withConfig({displayName:"landing__CTA",componentId:"sc-8xfovt-4"})(["margin-top:auto;padding:1rem 0 2rem;background:#393;color:#eee;> p{font-size:1.5em;text-align:center;}> button{margin:0 auto;font-size:2em;padding:1rem 2rem;}"]),fn=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=rn(a).call(this,e))||"object"!==on(o)&&"function"!=typeof o?cn(t):o).onSubmit=n.onSubmit.bind(cn(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&un(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentWillMount",value:function(){var e=this.props,n=e.fetchOrgs;e.isAuth&&n()}},{key:"componentDidUpdate",value:function(e){var n=e.isAuth,t=this.props,o=t.isAuth,a=t.fetchOrgs;!n&&o&&a()}},{key:"componentWillUnmount",value:function(){(0,this.props.hideDialog)("Org.Signup")}},{key:"onSubmit",value:function(e){var n=this.props,t=n.hideDialog,o=n.history,a=n.signup,r=e.target;e.preventDefault();var i=r.name.value;i&&a({name:i}).then(function(e){var n=e.value;return o.push("/".concat(n))}).catch(function(){}).finally(function(){return t("Org.Signup")})}},{key:"render",value:function(){var e=this.props,n=e.isAuth,t=e.orgs,o=e.showDialog;return m.a.createElement(tn,null,m.a.createElement(ln,null,m.a.createElement("h2",null,"BabelChat"),m.a.createElement("p",null,"Create your own language exchange service in seconds")),m.a.createElement(sn,null,m.a.createElement(pn,null,m.a.createElement("li",null,"1 to 1 conversations with students"),m.a.createElement("li",null,"Group videochat rooms (up to 8 peers)"),m.a.createElement("li",null,"Whiteboard with drag&drop image sharing"),m.a.createElement("li",null,"Customize it with your own branding"),m.a.createElement("li",null,"Integrate it onto your website"),m.a.createElement("li",null,"Free unlimited rooms/students while in open alpha")),m.a.createElement(dn,null,m.a.createElement("h3",null,"Your orgs"),n?t.map(function(e){var n=e.name,t=e.slug;return m.a.createElement(He.a,{key:t,to:{pathname:"/".concat(t)}},n)}):m.a.createElement(Ze,null))),m.a.createElement(mn,null,m.a.createElement("p",null,m.a.createElement(f.Translate,{value:"Org.CTA.copy"})),n?m.a.createElement(Re,{type:"button",onClick:function(){return o("Org.Signup")}},m.a.createElement(me.TiGroup,null),m.a.createElement(f.Translate,{value:"Org.CTA.button"})):m.a.createElement(Ze,{icon:me.TiGroup,label:"Org.CTA.button",onSession:function(){return o("Org.Signup")}})),m.a.createElement(Te,{id:"Org.Signup"},m.a.createElement(Pe,{onSubmit:this.onSubmit},m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"Org.Signup.name"})),m.a.createElement("input",{type:"text",name:"name"})),m.a.createElement("div",{className:"submit"},m.a.createElement(Re,{type:"submit"},m.a.createElement(me.TiPlus,null),m.a.createElement(f.Translate,{value:"Org.Signup.submit"}))))))}}])&&an(n.prototype,t),o&&an(n,o),a}();fn.propTypes={history:de.a.object.isRequired,isAuth:de.a.bool.isRequired,orgs:de.a.arrayOf(de.a.shape({name:de.a.string.isRequired,slug:de.a.string.isRequired})).isRequired,fetchOrgs:de.a.func.isRequired,hideDialog:de.a.func.isRequired,showDialog:de.a.func.isRequired,signup:de.a.func.isRequired};var hn=Object(u.connect)(function(e){var n=e.user;return{isAuth:n.isAuth,orgs:n.orgs}},{fetchOrgs:function(){return{type:"USER/FETCH_ORGS",payload:U.fetch({endpoint:"user/orgs"})}},hideDialog:fe,showDialog:he,signup:function(e){var n=e.name;return{type:"ORG/SIGNUP",payload:U.fetch({body:{name:n},endpoint:"orgs",method:"PUT"})}}})(fn),gn=pe.a.div.withConfig({displayName:"sc-404__Wrapper",componentId:"ga9xrh-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;justify-content:center;"]),yn=pe.a.div.withConfig({displayName:"sc-404__Status",componentId:"ga9xrh-1"})(["font-size:6em;line-height:0.8em;color:#656565;margin-bottom:2rem;"]),vn=pe.a.div.withConfig({displayName:"sc-404__Description",componentId:"ga9xrh-2"})(["font-size:1.5em;"]),bn=pe.a.div.withConfig({displayName:"sc-404__Alternative",componentId:"ga9xrh-3"})(["margin:2rem 0 4rem;> a{text-decoration:none;font-size:1.2em;}"]),wn=function(){return m.a.createElement(gn,null,m.a.createElement(yn,null,"404"),m.a.createElement(vn,null,m.a.createElement(f.Translate,{value:"NotFound.description"})),m.a.createElement(bn,null,m.a.createElement(He.a,{to:{pathname:"/"}},m.a.createElement(Re,{type:"button",primary:!0},m.a.createElement(me.TiArrowBack,null),m.a.createElement(f.Translate,{value:"NotFound.goBack"})))))},En=[{name:"Afghanistan",code:"af"},{name:"Åland Islands",code:"ax"},{name:"Albania",code:"al"},{name:"Algeria",code:"dz"},{name:"American Samoa",code:"as"},{name:"Andorra",code:"ad"},{name:"Angola",code:"ao"},{name:"Anguilla",code:"ai"},{name:"Antarctica",code:"aq"},{name:"Antigua and Barbuda",code:"ag"},{name:"Argentina",code:"ar"},{name:"Armenia",code:"am"},{name:"Aruba",code:"aw"},{name:"Australia",code:"au"},{name:"Austria",code:"at"},{name:"Azerbaijan",code:"az"},{name:"Bahamas",code:"bs"},{name:"Bahrain",code:"bh"},{name:"Bangladesh",code:"bd"},{name:"Barbados",code:"bb"},{name:"Belarus",code:"by"},{name:"Belgium",code:"be"},{name:"Belize",code:"bz"},{name:"Benin",code:"bj"},{name:"Bermuda",code:"bm"},{name:"Bhutan",code:"bt"},{name:"Bolivia, Plurinational State of",code:"bo"},{name:"Bonaire, Sint Eustatius and Saba",code:"bq"},{name:"Bosnia and Herzegovina",code:"ba"},{name:"Botswana",code:"bw"},{name:"Bouvet Island",code:"bv"},{name:"Brazil",code:"br"},{name:"British Indian Ocean Territory",code:"io"},{name:"Brunei Darussalam",code:"bn"},{name:"Bulgaria",code:"bg"},{name:"Burkina Faso",code:"bf"},{name:"Burundi",code:"bi"},{name:"Cambodia",code:"kh"},{name:"Cameroon",code:"cm"},{name:"Canada",code:"ca"},{name:"Cape Verde",code:"cv"},{name:"Catalonia",code:"es-ct"},{name:"Cayman Islands",code:"ky"},{name:"Central African Republic",code:"cf"},{name:"Chad",code:"td"},{name:"Chile",code:"cl"},{name:"China",code:"cn"},{name:"Christmas Island",code:"cx"},{name:"Cocos (Keeling) Islands",code:"cc"},{name:"Colombia",code:"co"},{name:"Comoros",code:"km"},{name:"Congo",code:"cg"},{name:"Congo, the Democratic Republic of the",code:"cd"},{name:"Cook Islands",code:"ck"},{name:"Costa Rica",code:"cr"},{name:"Côte d'Ivoire",code:"ci"},{name:"Croatia",code:"hr"},{name:"Cuba",code:"cu"},{name:"Curaçao",code:"cw"},{name:"Cyprus",code:"cy"},{name:"Czech Republic",code:"cz"},{name:"Denmark",code:"dk"},{name:"Djibouti",code:"dj"},{name:"Dominica",code:"dm"},{name:"Dominican Republic",code:"do"},{name:"Ecuador",code:"ec"},{name:"Egypt",code:"eg"},{name:"El Salvador",code:"sv"},{name:"Equatorial Guinea",code:"gq"},{name:"Eritrea",code:"er"},{name:"Estonia",code:"ee"},{name:"Ethiopia",code:"et"},{name:"European Union",code:"eu"},{name:"Falkland Islands (Malvinas)",code:"fk"},{name:"Faroe Islands",code:"fo"},{name:"Fiji",code:"fj"},{name:"Finland",code:"fi"},{name:"France",code:"fr"},{name:"French Guiana",code:"gf"},{name:"French Polynesia",code:"pf"},{name:"French Southern Territories",code:"tf"},{name:"Gabon",code:"ga"},{name:"Gambia",code:"gm"},{name:"Georgia",code:"ge"},{name:"Germany",code:"de"},{name:"Ghana",code:"gh"},{name:"Gibraltar",code:"gi"},{name:"Greece",code:"gr"},{name:"Greenland",code:"gl"},{name:"Grenada",code:"gd"},{name:"Guadeloupe",code:"gp"},{name:"Guam",code:"gu"},{name:"Guatemala",code:"gt"},{name:"Guernsey",code:"gg"},{name:"Guinea",code:"gn"},{name:"Guinea-Bissau",code:"gw"},{name:"Guyana",code:"gy"},{name:"Haiti",code:"ht"},{name:"Heard Island and McDonald Islands",code:"hm"},{name:"Holy See (Vatican City State)",code:"va"},{name:"Honduras",code:"hn"},{name:"Hong Kong",code:"hk"},{name:"Hungary",code:"hu"},{name:"Iceland",code:"is"},{name:"India",code:"in"},{name:"Indonesia",code:"id"},{name:"Iran, Islamic Republic of",code:"ir"},{name:"Iraq",code:"iq"},{name:"Ireland",code:"ie"},{name:"Isle of Man",code:"im"},{name:"Israel",code:"il"},{name:"Italy",code:"it"},{name:"Jamaica",code:"jm"},{name:"Japan",code:"jp"},{name:"Jersey",code:"je"},{name:"Jordan",code:"jo"},{name:"Kazakhstan",code:"kz"},{name:"Kenya",code:"ke"},{name:"Kiribati",code:"ki"},{name:"Korea, Democratic People's Republic of",code:"kp"},{name:"Korea, Republic of",code:"kr"},{name:"Kuwait",code:"kw"},{name:"Kyrgyzstan",code:"kg"},{name:"Lao People's Democratic Republic",code:"la"},{name:"Latvia",code:"lv"},{name:"Lebanon",code:"lb"},{name:"Lesotho",code:"ls"},{name:"Liberia",code:"lr"},{name:"Libya",code:"ly"},{name:"Liechtenstein",code:"li"},{name:"Lithuania",code:"lt"},{name:"Luxembourg",code:"lu"},{name:"Macao",code:"mo"},{name:"Macedonia, the Former Yugoslav Republic of",code:"mk"},{name:"Madagascar",code:"mg"},{name:"Malawi",code:"mw"},{name:"Malaysia",code:"my"},{name:"Maldives",code:"mv"},{name:"Mali",code:"ml"},{name:"Malta",code:"mt"},{name:"Marshall Islands",code:"mh"},{name:"Martinique",code:"mq"},{name:"Mauritania",code:"mr"},{name:"Mauritius",code:"mu"},{name:"Mayotte",code:"yt"},{name:"Mexico",code:"mx"},{name:"Micronesia, Federated States of",code:"fm"},{name:"Moldova, Republic of",code:"md"},{name:"Monaco",code:"mc"},{name:"Mongolia",code:"mn"},{name:"Montenegro",code:"me"},{name:"Montserrat",code:"ms"},{name:"Morocco",code:"ma"},{name:"Mozambique",code:"mz"},{name:"Myanmar",code:"mm"},{name:"Namibia",code:"na"},{name:"Nauru",code:"nr"},{name:"Nepal",code:"np"},{name:"Netherlands",code:"nl"},{name:"New Caledonia",code:"nc"},{name:"New Zealand",code:"nz"},{name:"Nicaragua",code:"ni"},{name:"Niger",code:"ne"},{name:"Nigeria",code:"ng"},{name:"Niue",code:"nu"},{name:"Norfolk Island",code:"nf"},{name:"Northern Mariana Islands",code:"mp"},{name:"Norway",code:"no"},{name:"Oman",code:"om"},{name:"Pakistan",code:"pk"},{name:"Palau",code:"pw"},{name:"Palestine, State of",code:"ps"},{name:"Panama",code:"pa"},{name:"Papua New Guinea",code:"pg"},{name:"Paraguay",code:"py"},{name:"Peru",code:"pe"},{name:"Philippines",code:"ph"},{name:"Pitcairn",code:"pn"},{name:"Poland",code:"pl"},{name:"Portugal",code:"pt"},{name:"Puerto Rico",code:"pr"},{name:"Qatar",code:"qa"},{name:"Réunion",code:"re"},{name:"Romania",code:"ro"},{name:"Russian Federation",code:"ru"},{name:"Rwanda",code:"rw"},{name:"Saint Barthélemy",code:"bl"},{name:"Saint Helena, Ascension and Tristan da Cunha",code:"sh"},{name:"Saint Kitts and Nevis",code:"kn"},{name:"Saint Lucia",code:"lc"},{name:"Saint Martin (French part)",code:"mf"},{name:"Saint Pierre and Miquelon",code:"pm"},{name:"Saint Vincent and the Grenadines",code:"vc"},{name:"Samoa",code:"ws"},{name:"San Marino",code:"sm"},{name:"Sao Tome and Principe",code:"st"},{name:"Saudi Arabia",code:"sa"},{name:"Senegal",code:"sn"},{name:"Serbia",code:"rs"},{name:"Seychelles",code:"sc"},{name:"Sierra Leone",code:"sl"},{name:"Singapore",code:"sg"},{name:"Sint Maarten (Dutch part)",code:"sx"},{name:"Slovakia",code:"sk"},{name:"Slovenia",code:"si"},{name:"Solomon Islands",code:"sb"},{name:"Somalia",code:"so"},{name:"South Africa",code:"za"},{name:"South Georgia and the South Sandwich Islands",code:"gs"},{name:"South Sudan",code:"ss"},{name:"Spain",code:"es"},{name:"Sri Lanka",code:"lk"},{name:"Sudan",code:"sd"},{name:"Suriname",code:"sr"},{name:"Svalbard and Jan Mayen",code:"sj"},{name:"Swaziland",code:"sz"},{name:"Sweden",code:"se"},{name:"Switzerland",code:"ch"},{name:"Syrian Arab Republic",code:"sy"},{name:"Taiwan, Province of China",code:"tw"},{name:"Tajikistan",code:"tj"},{name:"Tanzania, United Republic of",code:"tz"},{name:"Thailand",code:"th"},{name:"Timor-Leste",code:"tl"},{name:"Togo",code:"tg"},{name:"Tokelau",code:"tk"},{name:"Tonga",code:"to"},{name:"Trinidad and Tobago",code:"tt"},{name:"Tunisia",code:"tn"},{name:"Turkey",code:"tr"},{name:"Turkmenistan",code:"tm"},{name:"Turks and Caicos Islands",code:"tc"},{name:"Tuvalu",code:"tv"},{name:"Uganda",code:"ug"},{name:"Ukraine",code:"ua"},{name:"United Arab Emirates",code:"ae"},{name:"United Kingdom",code:"gb"},{name:"England",code:"gb-eng"},{name:"Northern Ireland",code:"gb-nir"},{name:"Scotland",code:"gb-sct"},{name:"Wales",code:"gb-wls"},{name:"United Nations",code:"un"},{name:"United States",code:"us"},{name:"United States Minor Outlying Islands",code:"um"},{name:"Uruguay",code:"uy"},{name:"Uzbekistan",code:"uz"},{name:"Vanuatu",code:"vu"},{name:"Venezuela, Bolivarian Republic of",code:"ve"},{name:"Viet Nam",code:"vn"},{name:"Virgin Islands, British",code:"vg"},{name:"Virgin Islands, U.S.",code:"vi"},{name:"Wallis and Futuna",code:"wf"},{name:"Western Sahara",code:"eh"},{name:"Yemen",code:"ye"},{name:"Zambia",code:"zm"},{name:"Zimbabwe",code:"zw"}];function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Sn(e){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _n(e,n){return(_n=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var jn=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Sn(a).call(this,e))||"object"!==On(o)&&"function"!=typeof o?kn(t):o).onSubmit=n.onSubmit.bind(kn(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&_n(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"onSubmit",value:function(e){var n=this.props.createRoom,t=e.target;e.preventDefault();var o=t.flag.value,a=t.name.value,r=parseInt(t.peerLimit.value,10);o&&a&&r&&n({flag:o,name:a,peerLimit:r})}},{key:"render",value:function(){return m.a.createElement(Te,{id:"Org.CreateRoom"},m.a.createElement(Pe,{onSubmit:this.onSubmit},m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"Org.CreateRoom.name"})),m.a.createElement("input",{type:"text",name:"name",required:!0,autoFocus:!0})),m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"Org.CreateRoom.flag"})),m.a.createElement("select",{name:"flag",defaultValue:"gb",required:!0},En.map(function(e){var n=e.code,t=e.name;return m.a.createElement("option",{key:n,value:n},t)}))),m.a.createElement("div",null,m.a.createElement("label",null,m.a.createElement(f.Translate,{value:"Org.CreateRoom.peerLimit"})),m.a.createElement("input",{type:"number",name:"peerLimit",min:"2",max:"8",defaultValue:"8",required:!0})),m.a.createElement("div",{className:"submit"},m.a.createElement(Re,{type:"submit"},m.a.createElement(me.TiPlus,null),m.a.createElement(f.Translate,{value:"Org.CreateRoom.submit"})))))}}])&&Rn(n.prototype,t),o&&Rn(n,o),a}();jn.propTypes={createRoom:de.a.func.isRequired};var In=Object(u.connect)(function(){return{}},{createRoom:function(e){var o=e.flag,a=e.name,r=e.peerLimit;return function(e,n){var t=n().org.id;return e({type:"ORG/CREATE_ROOM",payload:U.fetch({body:{flag:o,name:a,peerLimit:r},endpoint:"org/".concat(t,"/rooms"),method:"PUT"})})}}})(jn);function Tn(e){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Cn(e,n){return!n||"object"!==Tn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function An(e,n){return(An=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var qn=pe.a.div.withConfig({displayName:"rooms__Listing",componentId:"j6zg2b-0"})(["display:flex;flex-direction:column;align-items:center;> a{display:flex;box-sizing:border-box;width:100%;align-items:center;justify-content:space-between;font-size:1.5em;padding:1rem;color:#000;text-decoration:none;transition:color ease-out .15s,background-color ease-out .15s;will-change:color,background-color;&:nth-child(even){background:#ddd;}&.full{opacity:0.5;pointer-events:none;}> strong > img{width:1.5rem;height:1.125rem;margin-right:1rem;vertical-align:middle;}&:hover{color:#eee;background-color:#393;}}&.admin > a{> svg{display:none;}&:hover{> span{display:none;}> svg{display:block;}}}"]),Ln=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Cn(this,xn(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&An(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentDidMount",value:function(){(0,this.props.fetch)()}},{key:"onRemove",value:function(e,n){var t=this.props.removeRoom;e.preventDefault(),t(n)}},{key:"render",value:function(){var i=this,e=this.props,c=e.isAdmin,n=e.list,u=e.org;return m.a.createElement(qn,{className:c?"admin":null},n.map(function(e){var n=e.flag,t=e.name,o=e.peerLimit,a=e.peers,r=e.slug;return m.a.createElement(He.a,{key:r,to:{pathname:"/".concat(u,"/").concat(r)},className:o<=a?"full":""},m.a.createElement("strong",null,m.a.createElement("img",{src:"".concat("https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/flags/4x3/").concat(n,".svg")}),t),m.a.createElement(f.Translate,{count:a,limit:o,value:"Rooms.peers"}),c?m.a.createElement(me.TiTrash,{onClick:function(e){return i.onRemove(e,r)}}):null)}))}}])&&Pn(t.prototype,o),a&&Pn(t,a),n}();Ln.propTypes={isAdmin:de.a.bool.isRequired,list:de.a.arrayOf(de.a.shape({flag:de.a.string.isRequired,name:de.a.string.isRequired,peerLimit:de.a.number.isRequired,peers:de.a.number.isRequired,slug:de.a.string.isRequired})).isRequired,org:de.a.string.isRequired,fetch:de.a.func.isRequired,removeRoom:de.a.func.isRequired};var Mn=Object(u.connect)(function(e){var n=e.org;return{isAdmin:n.isAdmin,list:n.rooms}},{fetch:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/FETCH_ROOMS",payload:U.fetch({endpoint:"org/".concat(t,"/rooms")})})}},removeRoom:function(o){return function(e,n){var t=n().org.id;return e({type:"ORG/REMOVE_ROOM",payload:U.fetch({endpoint:"org/".concat(t,"/room/").concat(o),method:"DELETE"}).then(function(){return{slug:o}})})}}})(Ln);function Nn(e){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Un(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Dn(e,n){return!n||"object"!==Nn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function zn(e){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gn(e,n){return(Gn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Fn=pe.a.div.withConfig({displayName:"users__Scroll",componentId:"sc-1u1f4yo-0"})(["max-height:400px;overflow-y:auto;"]),Bn=pe.a.div.withConfig({displayName:"users__User",componentId:"sc-1u1f4yo-1"})(["display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:0.5rem;&:last-child{margin-bottom:0;}> div{display:flex;align-items:center;> button{margin-left:0.5rem;}> img{width:32px;height:32px;border-radius:16px;margin-right:0.5rem;vertical-align:middle;}}> button{display:none;padding:0.2rem 1rem;font-size:1.4rem;}&:hover > button{display:flex;}"]),Wn=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Dn(this,zn(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Gn(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentDidMount",value:function(){(0,this.props.fetch)()}},{key:"render",value:function(){var e=this.props,n=e.list,a=e.removeUser,r=e.resolveRequest;return m.a.createElement(Te,{id:"Org.ManageUsers",width:"512px"},m.a.createElement(Fn,null,n.map(function(e){var n=e._id,t=e.isRequest,o=e.name;return m.a.createElement(Bn,{key:n},m.a.createElement("div",null,m.a.createElement("img",{src:"".concat(U.baseURL,"user/").concat(n,"/photo?auth=").concat(U.token)}),o),t?m.a.createElement("div",null,m.a.createElement(Re,{type:"button",onClick:function(){return r({user:n,resolution:"decline"})}},m.a.createElement(me.TiTimes,null),m.a.createElement(f.Translate,{value:"Org.ManageUsers.decline"})),m.a.createElement(Re,{type:"button",onClick:function(){return r({user:n,resolution:"approve"})},primary:!0},m.a.createElement(me.TiTick,null),m.a.createElement(f.Translate,{value:"Org.ManageUsers.approve"}))):m.a.createElement(Re,{type:"button",onClick:function(){return a(n)}},m.a.createElement(me.TiTrash,null)))})))}}])&&Un(t.prototype,o),a&&Un(t,a),n}();Wn.propTypes={list:de.a.arrayOf(de.a.shape({_id:de.a.string.isRequired,isRequest:de.a.bool,name:de.a.string.isRequired})).isRequired,fetch:de.a.func.isRequired,removeUser:de.a.func.isRequired,resolveRequest:de.a.func.isRequired};var Hn=Object(u.connect)(function(e){return{list:e.org.users}},{fetch:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/FETCH_USERS",payload:U.fetch({endpoint:"org/".concat(t,"/users")})})}},removeUser:function(o){return function(e,n){var t=n().org.id;return e({type:"ORG/REMOVE_USER",payload:U.fetch({endpoint:"org/".concat(t,"/user/").concat(o),method:"DELETE"}).then(function(){return{user:o}})})}},resolveRequest:function(e){var o=e.user,a=e.resolution;return function(e,n){var t=n().org.id;return e({type:"ORG/RESOLVE_REQUEST",payload:U.fetch({endpoint:"org/".concat(t,"/user/").concat(o,"/").concat(a),method:"POST"}).then(function(){return{user:o,resolution:a}})})}}})(Wn);function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],o=!0,a=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kn(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Yn(e,n){return!n||"object"!==Vn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xn(e,n){return(Xn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Zn=Object(pe.a)(tn).withConfig({displayName:"org__Layout",componentId:"lwp656-0"})(["flex-direction:row;> div{box-sizing:border-box;flex-shrink:0;}"]),$n=pe.a.div.withConfig({displayName:"org__Nav",componentId:"lwp656-1"})(["display:flex;width:",";flex-direction:column;align-items:center;padding:1rem;background:#222;color:#eee;"],"212px"),et=pe.a.div.withConfig({displayName:"org__Content",componentId:"lwp656-2"})(["width:calc(100% - ",");display:flex;flex-direction:column;"],"212px"),nt="\n  > button {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 0.25rem;\n    display: flex;\n    font-size: 1.5em;\n    border-radius: 2px 0 0 0;\n    opacity: 0;\n    transition: opacity ease-out .2s;\n  }\n  &:hover > button {\n    opacity: 1;    \n  }\n",tt=pe.a.div.withConfig({displayName:"org__Logo",componentId:"lwp656-3"})(["position:relative;> img{width:180px;height:180px;background:#000;overflow:hidden;vertical-align:middle;}",""],nt),ot=pe.a.div.withConfig({displayName:"org__Name",componentId:"lwp656-4"})(["width:100%;font-size:1.666em;padding:1rem 0 0.5rem;"]),at=pe.a.div.withConfig({displayName:"org__Url",componentId:"lwp656-5"})(["display:flex;justify-content:space-between;width:100%;padding:0 0 1.5rem;color:#aaa;user-select:all;> a{font-size:1.5em;}"]),rt=pe.a.div.withConfig({displayName:"org__Actions",componentId:"lwp656-6"})(["width:100%;display:flex;flex-direction:column;align-items:center;> button{width:100%;margin:0 0 0.5rem;justify-content:flex-start;> svg{font-size:1.5em;margin-right:0.25rem;}.count{display:flex;margin-left:auto;align-items:center;justify-content:center;width:18px;height:18px;background-color:#393;border-radius:9px;font-size:0.85em;line-height:1em;transition:background-color ease-out .2s;will-change:background-color;transform:translate(25%,0);}&:hover .count{background-color:#111;}}"]),it=pe.a.div.withConfig({displayName:"org__Cover",componentId:"lwp656-7"})(["flex-shrink:0;background:#000;background-repeat:no-repeat;background-size:cover;background-position:center;background-image:url(",");width:100%;height:312px;position:relative;",""],function(e){return e.cover},nt),ct=pe.a.div.withConfig({displayName:"org__Section",componentId:"lwp656-8"})(["display:flex;flex-direction:column;align-items:center;padding:3rem 0;> p{font-size:1.5rem;color:#666;}> button > svg{font-size:2em;}"]),ut=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Yn(this,Qn(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Xn(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentWillMount",value:function(){this.fetch()}},{key:"componentDidUpdate",value:function(e){e.isAuth!==this.props.isAuth&&this.fetch()}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.hideDialog;(0,e.reset)(),n("Org.CreateRoom"),n("Org.ManageUsers")}},{key:"fetch",value:function(){var e=this.props,n=e.match.params.slug,t=e.fetch,o=e.history;t(n).catch(function(){return o.replace("404")})}},{key:"updateImage",value:function(n){var t=this.props.updateImage,o=document.createElement("input");o.accept="image/*",o.type="file",o.onchange=function(){var e=Jn(o.files,1)[0];e&&t({image:n,blob:e}).then(function(){return window.location.reload()})},o.click()}},{key:"render",value:function(){var e=this,n=this.props,t=n.hasLoaded,o=n.id,a=n.isActive,r=n.isAdmin,i=n.isAuth,c=n.isUser,u=n.requestAccess,l=n.match.params.slug,s=n.name,d=n.pendingRequests,p=n.showDialog;return t?m.a.createElement(Zn,null,m.a.createElement($n,null,m.a.createElement(tt,null,m.a.createElement("img",{src:"".concat(U.baseURL,"org/").concat(o,"/logo")}),r?m.a.createElement(Re,{type:"button",onClick:function(){return e.updateImage("logo")}},m.a.createElement(me.TiUpload,null)):null),m.a.createElement(ot,null,s),m.a.createElement(at,null,"".concat("babelchat.tk").concat("/").concat(l),r?m.a.createElement("a",{onClick:function(){return document.execCommand("copy")}},m.a.createElement(me.TiClipboard,null)):null),r?m.a.createElement(rt,null,m.a.createElement(Re,{type:"button",onClick:function(){return p("Org.ManageUsers")}},m.a.createElement(me.TiGroup,null),m.a.createElement(f.Translate,{value:"Org.Nav.manageUsers"}),0<d?m.a.createElement("span",{className:"count"},d):null),m.a.createElement(Re,{type:"button",onClick:function(){return p("Org.CreateRoom")}},m.a.createElement(me.TiMessages,null),m.a.createElement(f.Translate,{value:"Org.Nav.createRoom"}))):null),m.a.createElement(et,null,m.a.createElement(it,{cover:"".concat(U.baseURL,"org/").concat(o,"/cover")},r?m.a.createElement(Re,{type:"button",onClick:function(){return e.updateImage("cover")}},m.a.createElement(me.TiUpload,null)):null),c&&a?m.a.createElement(Mn,{org:l}):null,c&&!a?m.a.createElement(ct,null,m.a.createElement("p",null,"Your account is pending approval")):null,i&&!c?m.a.createElement(ct,null,m.a.createElement("p",null,"Your are not a student of this organization"),m.a.createElement(Re,{type:"button",onClick:u},"Request access")):null,i?null:m.a.createElement(ct,null,m.a.createElement("p",null,"Welcome, please sign-in:"),m.a.createElement(Ze,null)),r?m.a.createElement("div",null,m.a.createElement(In,null),m.a.createElement(Hn,null)):null)):null}}])&&Kn(t.prototype,o),a&&Kn(t,a),n}();ut.propTypes={match:de.a.shape({params:de.a.shape({slug:de.a.string.isRequired}).isRequired}).isRequired,hasLoaded:de.a.bool.isRequired,history:de.a.object.isRequired,id:de.a.string.isRequired,isActive:de.a.bool.isRequired,isAdmin:de.a.bool.isRequired,isAuth:de.a.bool.isRequired,isUser:de.a.bool.isRequired,name:de.a.string.isRequired,pendingRequests:de.a.number.isRequired,fetch:de.a.func.isRequired,hideDialog:de.a.func.isRequired,requestAccess:de.a.func.isRequired,reset:de.a.func.isRequired,showDialog:de.a.func.isRequired,updateImage:de.a.func.isRequired};var lt=Object(u.connect)(function(e){var n=e.org,t=n.hasLoaded,o=n.id,a=n.isActive,r=n.isAdmin,i=n.isUser,c=n.name,u=n.pendingRequests;return{hasLoaded:t,id:o,isActive:a,isAdmin:r,isAuth:e.user.isAuth,isUser:i,name:c,pendingRequests:u}},{fetch:function(e){return{type:"ORG/FETCH",payload:U.fetch({endpoint:"org/".concat(e)})}},hideDialog:fe,requestAccess:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/REQUEST_ACCESS",payload:U.fetch({endpoint:"org/".concat(t,"/users"),method:"PUT"})})}},reset:function(){return{type:w}},showDialog:he,updateImage:function(e){var a=e.image,r=e.blob;return function(e,n){var t=n().org.id,o=new FormData;return o.append("image",r),e({type:"ORG/UPDATE_IMAGE",payload:U.fetch({body:o,endpoint:"org/".concat(t,"/").concat(a),method:"POST"})})}}})(ut),st=t("fWck");function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],o=!0,a=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mt(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e,n){return(gt=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var yt=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=ft(a).call(this,e))||"object"!==dt(o)&&"function"!=typeof o?ht(t):o).dom=m.a.createRef(),n.onDrop=n.onDrop.bind(ht(n)),n.onPointerWheel=n.onPointerWheel.bind(ht(n)),n.onResize=n.onResize.bind(ht(n)),n.origin={x:0,y:0},n.scale=1,n.peers={},n.photos={},n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&gt(e,n)}(a,r["Component"]),n=a,o=[{key:"onDragOver",value:function(e){e.preventDefault()}}],(t=[{key:"componentDidMount",value:function(){var e=this.dom.current;this.loadPhotos(this.props),e.addEventListener("dragover",a.onDragOver,!1),e.addEventListener("drop",this.onDrop,!1),window.addEventListener("resize",this.onResize,!1),this.touches=Y()(window,{filtered:!0,preventSimulated:!1}).on("start",this.onPointerStart.bind(this)).on("move",this.onPointerMove.bind(this)).on("end",this.onPointerEnd.bind(this)),Object(st.addWheelListener)(window,this.onPointerWheel),this.onResize()}},{key:"componentWillReceiveProps",value:function(e){this.loadPhotos(e),this.draw(e)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){var e=this.dom.current;this.touches.disable(),e.removeEventListener("dragover",a.onDragOver),e.removeEventListener("drop",this.onDrop),Object(st.removeWheelListener)(window,this.onPointerWheel),window.removeEventListener("resize",this.onResize)}},{key:"onDrop",value:function(e){var n=this.props.socket,t=e.clientX,o=e.clientY,a=pt(e.dataTransfer.files,1)[0];if(e.preventDefault(),a){var r=this.getPointer([t,o]),i=new FileReader;i.onload=function(){n.send(JSON.stringify({type:"ROOM/ADD_PHOTO",payload:{origin:r,photo:i.result.substr(i.result.indexOf("base64")+7)}}))},i.readAsDataURL(a)}}},{key:"onPointerStart",value:function(e,n){var i=this,t=this.props,o=t.photos,a=t.socket,r=e.button||0,c=this.getPointer(n),u=c.x,l=c.y,s=o.filter(function(e){var n=e._id,t=e.origin,o=i.photos[n];if(!o)return!1;var a=o.width,r=o.height;return!(u<t.x||u>t.x+a||l<t.y||l>t.y+r)});s.reverse();var d=s[0];0===r&&!d||2===r?this.dragging={canvas:n}:0===r&&d&&(e.shiftKey?a.send(JSON.stringify({type:"ROOM/REMOVE_PHOTO",payload:{photo:d._id}})):this.dragging={offset:{x:d.origin.x-u,y:d.origin.y-l},photo:d})}},{key:"onPointerMove",value:function(e,n){var t=this.dragging,o=this.origin,a=this.scale,r=this.props.peers,i=this.getPointer(n),c=i.x,u=i.y;if(r.forEach(function(e){var n=e.connection;n._channel&&"open"===n._channel.readyState&&n.send(new Int32Array([c,u]))}),t){if(t.canvas&&(o.x+=(n[0]-t.canvas[0])/a,o.y+=(n[1]-t.canvas[1])/a,t.canvas=n),t.photo){var l=t.offset,s=t.photo;s.origin.x=c+l.x,s.origin.y=u+l.y}this.draw()}}},{key:"onPointerEnd",value:function(){var e=this.dragging,n=this.props.socket;if(e&&(delete this.dragging,e.photo)){var t=e.photo,o=t._id,a=t.origin;n.send(JSON.stringify({type:"ROOM/MOVE_PHOTO",payload:{origin:a,photo:o}}))}}},{key:"onPointerWheel",value:function(e){var n=e.deltaY,t=1+.075*Math.min(Math.max(-n,-1),1);this.scale*=t,this.scale=Math.min(Math.max(this.scale,.25),2),this.draw()}},{key:"onResize",value:function(){var e=this.dom.current;e.width=window.innerWidth,e.height=window.innerHeight,this.draw()}},{key:"getPointer",value:function(e){var n=pt(e,2),t=n[0],o=n[1],a=this.dom.current,r=this.origin,i=this.scale;return{x:Math.round((t-.5*a.width)/i-r.x),y:Math.round((o-.5*a.height)/i-r.y)}}},{key:"loadPhotos",value:function(e){var a=this,n=e.peers,t=e.photos;n.forEach(function(e){var n=e._id;if(!a.peers[n]){var t=new Image;t.src="".concat(U.baseURL,"user/").concat(n,"/photo?auth=").concat(U.token),t.onload=function(){return a.draw()},a.peers[n]=t}}),t.forEach(function(e){var n=e._id,t=e.photo;if(!a.photos[n]){var o=new Image;o.src="data:image/jpeg;base64,".concat(t),o.onload=function(){return a.draw()},a.photos[n]=o}})}},{key:"draw",value:function(e){var c=this,n=this.dom.current,t=this.origin,u=this.scale,o=e||this.props,a=o.name,r=o.peers,i=o.photos,l=n.getContext("2d");n.width=n.width,l.translate(.5*n.width,.5*n.height),l.scale(u,u),l.translate(t.x,t.y),l.textAlign="center",l.textBaseline="middle",l.fillStyle="#999",l.font="32px Arial",l.fillText(f.I18n.t("Room.".concat(a?"welcome":"joining"),{name:a}),0,0),i.forEach(function(e){var n=e._id,t=e.origin;c.photos[n]&&l.drawImage(c.photos[n],t.x,t.y)}),r.forEach(function(e){var n=e._id,t=e.pointer;if(c.peers[n]&&t){var o=pt(t,2),a=o[0],r=o[1],i=24/u;l.beginPath(),l.arc(a,r,i,0,2*Math.PI),l.fill(),l.save(),l.beginPath(),l.arc(a,r,.9*i,0,2*Math.PI),l.clip(),l.drawImage(c.peers[n],a-i,r-i,2*i,2*i),l.restore()}})}},{key:"render",value:function(){var e=this.dom;return m.a.createElement("canvas",{ref:e})}}])&&mt(n.prototype,t),o&&mt(n,o),a}();yt.propTypes={name:de.a.string.isRequired,peers:de.a.arrayOf(de.a.shape({_id:de.a.string.isRequired,connection:de.a.object.isRequired,pointer:de.a.arrayOf(de.a.number)})).isRequired,photos:de.a.arrayOf(de.a.shape({origin:de.a.shape({x:de.a.number.isRequired,y:de.a.number.isRequired}),photo:de.a.string.isRequired})).isRequired,socket:de.a.oneOfType([de.a.bool,de.a.object]).isRequired};var vt=Object(u.connect)(function(e){var n=e.room;return{name:n.name,peers:n.peers,photos:n.photos,socket:n.socket}})(yt),bt=t("9C/b"),wt=t("TX9C"),Et=t("BRrH"),Ot=t.n(Et);function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function kt(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(e){_t(n,e,t[e])})}return n}function _t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function jt(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(e,n){return(Pt=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Ct=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=It(a).call(this,e))||"object"!==Rt(o)&&"function"!=typeof o?Tt(t):o).onMessage=n.onMessage.bind(Tt(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Pt(e,n)}(a,r["Component"]),n=a,(t=[{key:"componentWillMount",value:function(){var e=this.props,n=e.match.params,t=n.org,o=n.slug,a=e.settings,r=a.audioInput,i=a.videoInput,c=e.startStream;this.connectToServer({org:t,slug:o}),navigator.mediaDevices.getUserMedia({audio:!r||{deviceId:{exact:r}},video:kt({width:640,height:640},i?{deviceId:{exact:i}}:{facingMode:"user"})}).then(c).catch(function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(c).catch(function(){})})}},{key:"componentWillReceiveProps",value:function(e){var n=e.match.params,t=n.org,o=n.slug,a=this.props,r=a.match.params,i=r.org,c=r.slug,u=a.reset;i===t&&c===o||(u(),this.connectToServer({org:t,slug:o}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){var e=this.socket,n=this.props,t=n.hideLoading,o=n.reset;e.readyState===wt.a.CONNECTING&&t(),e.close(1e3),o()}},{key:"onMessage",value:function(e){var n,t=this,o=e.data,a=this.socket,r=this.props,i=r.match.params.org,c=r.addPhoto,u=r.history,l=r.join,s=r.movePhoto,d=r.peerJoin,p=r.peerLeave,m=r.peerSignal,f=r.removePhoto;try{n=JSON.parse(o)}catch(e){return}switch(n.type){case E:c(n.payload);break;case I:s(n.payload);break;case T:f(n.payload);break;case O:l(kt({},n.payload,{peers:n.payload.peers.map(function(e){return t.connectToPeer(e,!0)}),socket:a}));break;case R:d(this.connectToPeer(n.payload));break;case S:p(n.payload);break;case _:m(n.payload);break;case"ROOM/ERROR":u.replace("FULL_ROOM"===n.payload?"/".concat(i):"/404")}}},{key:"connectToServer",value:function(e){var n=this,t=e.org,o=e.slug,a=this.props,r=a.hideLoading,i=a.showLoading;this.socket&&(this.socket.readyState===wt.a.CONNECTING&&r(),this.socket.close(1e3)),i(),this.socket=new wt.a("".concat(U.baseURL.replace(/http/,"ws"),"org/").concat(t,"/room/").concat(o),U.token),this.socket.onopen=function(){n.socket.onclose=null,n.socket.onerror=null,r()},this.socket.onmessage=this.onMessage}},{key:"connectToPeer",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.socket,o=this.props,a=o.stream,r=o.peerPointer,i=o.peerStream;return t.connection=new Ot.a({initiator:e,stream:a}),t.connection.on("signal",function(e){n.send(JSON.stringify({type:"ROOM/PEER_SIGNAL",payload:{peer:t.peer,signal:e}}))}),t.connection.on("data",function(e){var n=e.buffer;return r({peer:t.peer,pointer:St(new Int32Array(n))})}),t.connection.on("stream",function(e){return i({peer:t.peer,stream:e})}),t}},{key:"render",value:function(){return null}}])&&jt(n.prototype,t),o&&jt(n,o),a}();Ct.propTypes={history:de.a.object.isRequired,match:de.a.shape({params:de.a.shape({org:de.a.string.isRequired,slug:de.a.string.isRequired}).isRequired}).isRequired,settings:de.a.shape({audioInput:de.a.string.isRequired,videoInput:de.a.string.isRequired}).isRequired,stream:de.a.oneOfType([de.a.bool,de.a.object]).isRequired,addPhoto:de.a.func.isRequired,hideLoading:de.a.func.isRequired,join:de.a.func.isRequired,movePhoto:de.a.func.isRequired,removePhoto:de.a.func.isRequired,reset:de.a.func.isRequired,peerJoin:de.a.func.isRequired,peerLeave:de.a.func.isRequired,peerPointer:de.a.func.isRequired,peerSignal:de.a.func.isRequired,peerStream:de.a.func.isRequired,showLoading:de.a.func.isRequired,startStream:de.a.func.isRequired};var xt=Object(bt.a)(Object(u.connect)(function(e){var n=e.user;return{settings:n.settings,stream:n.stream}},{addPhoto:function(e){var n=e._id,t=e.origin,o=e.photo;return{type:E,payload:{_id:n,origin:t,photo:o}}},hideLoading:l.hideLoading,join:function(e){var n=e.name,t=e.peers,o=e.photos,a=e.socket;return{type:O,payload:{name:n,peers:t,photos:o,socket:a}}},movePhoto:function(e){var n=e.origin,t=e.photo;return{type:I,payload:{origin:n,photo:t}}},removePhoto:function(e){var n=e.photo;return{type:T,payload:{photo:n}}},reset:function(){return{type:P}},peerJoin:function(e){return{type:R,payload:{peer:e}}},peerLeave:function(e){var n=e.peer;return{type:S,payload:{peer:n}}},peerPointer:function(e){var n=e.peer,t=e.pointer;return{type:k,payload:{peer:n,pointer:t}}},peerSignal:function(e){var n=e.peer,t=e.signal;return{type:_,payload:{peer:n,signal:t}}},peerStream:function(e){var n=e.peer,t=e.stream;return{type:j,payload:{peer:n,stream:t}}},showLoading:l.showLoading,startStream:function(t){return function(e,n){n().user.isAudioMuted&&t.getAudioTracks().forEach(function(e){e.enabled=!1}),e({type:L,payload:{stream:t}})}}})(Ct)),At=pe.a.div.withConfig({displayName:"peers__Listing",componentId:"j59ndp-0"})(["position:absolute;top:100px;right:0;> img,> div > video{display:block;background:#000;width:100px;height:100px;vertical-align:middle;box-shadow:0 0 10px rgba(0,0,0,.5);}"]),qt=function(e){var n=e.peers;return m.a.createElement(At,null,n.map(function(e){var n=e._id,t=e.peer,o=e.video;return o&&o.srcObject.getVideoTracks().length?m.a.createElement(Oe,{key:t,video:o}):m.a.createElement("img",{key:t,src:"".concat(U.baseURL,"user/").concat(n,"/photo?auth=").concat(U.token)})}))};qt.propTypes={peers:de.a.arrayOf(de.a.shape({_id:de.a.string.isRequired,peer:de.a.string.isRequired,video:de.a.object})).isRequired};var Lt=Object(u.connect)(function(e){return{peers:e.room.peers}})(qt),Mt=function(){return m.a.createElement("div",null,m.a.createElement(vt,null),m.a.createElement(xt,null),m.a.createElement(Lt,null))};function Nt(){return(Nt=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Ut(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],0<=n.indexOf(t)||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],0<=n.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var Dt,zt,Gt,Ft,Bt=Object(u.connect)(function(e){return{isAuth:e.user.isAuth}})(function(e){var n=e.component,t=e.isAuth,o=e.requiresAuth,a=e.requiresNoAuth,r=Ut(e,["component","isAuth","requiresAuth","requiresNoAuth"]),i=o&&!t||a&&t;return m.a.createElement(ce.a,Nt({},r,{render:function(e){return i?m.a.createElement(ue.a,{to:"/"}):m.a.createElement(n,e)}}))}),Wt=function(){return m.a.createElement(We,null,m.a.createElement(le.a,null,m.a.createElement(Bt,{exact:!0,path:"/",component:hn}),m.a.createElement(Bt,{exact:!0,path:"/404",component:wn}),m.a.createElement(Bt,{exact:!0,path:"/:org/:slug",component:Mt,requiresAuth:!0}),m.a.createElement(Bt,{exact:!0,path:"/:slug",component:lt}),m.a.createElement(Bt,{path:"*",component:wn})))},Ht=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,i.d),Vt=Object(i.e)(ie,{},Ht(Object(i.a)(p.a,c.a,Object(l.loadingBarMiddleware)())));Dt=Vt,zt=localStorage.getItem("BABELCHAT::LOCALE"),Gt=((window.navigator.languages?window.navigator.languages[0]:null)||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage||"en").substr(0,2).toLowerCase(),Ft="en",~F.indexOf(zt)?Ft=zt:~F.indexOf(Gt)&&(Ft=Gt),Object(f.syncTranslationWithStore)(Dt),Dt.dispatch(Object(f.loadTranslations)(B)),Dt.dispatch(Object(f.setLocale)(Ft)),Vt.getState().user.isAuth&&Vt.dispatch(D());var Jt=Object(o.a)({basename:"/"});window.location.hash&&Jt.replace("/".concat(window.location.hash.substr(2))),window.addEventListener("contextmenu",function(e){return e.preventDefault()},!1);var Kt=document.getElementById("mount");Object(a.render)(m.a.createElement(u.Provider,{store:Vt},m.a.createElement(d.a,{history:Jt},m.a.createElement(Wt,null))),Kt)},p2bk:function(e,n,t){}},[[0,1,2]]]);
//# sourceMappingURL=main.b522a3b47d337d392a2a79db836bd944.js.map