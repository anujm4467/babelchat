(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{0:function(e,n,t){t("55Il"),t("p2bk"),e.exports=t("7RL8")},1:function(e,n){},2:function(e,n){},3:function(e,n){},"7RL8":function(e,n,t){"use strict";t.r(n);var o=t("YHGo"),r=t("q1tI"),f=t.n(r),a=t("i8i4"),i=t("ANjH"),c=t("Igns"),u=t("/MKj"),s=t("gyEF"),l=t.n(s),d=t("aJ4A"),p=t("sINF"),h=t("N2Rb"),m="USER/HIDE_SETTINGS",g="USER/REFRESH_SESSION_FULFILLED",y="USER/REFRESH_SESSION_REJECTED",v="USER/SAVE_SETTINGS",b="USER/SHOW_SETTINGS",w="USER/SIGNOUT",E="USER/START_STREAM",O="SESSION/TOGGLE_AUDIO",S="ORG/CREATE_ROOM_FULFILLED",R="ORG/FETCH_FULFILLED",k="ORG/FETCH_USERS_FULFILLED",_="ORG/HIDE_CREATE_ROOM",I="ORG/HIDE_SIGNUP",T="ORG/HIDE_USERS",j="ORG/RESOLVE_REQUEST_FULFILLED",C="ORG/RESET",P="ORG/SHOW_CREATE_ROOM",x="ORG/SHOW_SIGNUP",A="ORG/SHOW_USERS",q="ROOM/ADD_PHOTO",L="ROOM/JOIN",N="ROOM/PEER_JOIN",M="ROOM/PEER_LEAVE",U="ROOM/PEER_POINTER",z="ROOM/PEER_SIGNAL",G="ROOM/PEER_STREAM",D="ROOM/MOVE_PHOTO",F="ROOM/REMOVE_PHOTO",W="ROOM/RESET";function B(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var H=new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseURL="https://api.babelchat.tk/"}var n,t,o;return n=e,(t=[{key:"fetch",value:function(n){function e(e){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(e){var n=e.body,t=e.endpoint,o=e.headers,a=void 0===o?{}:o,r=e.method,i=void 0===r?"GET":r,c=this.authorization,u=this.baseURL;return c&&(a.Authorization=c),!n||n instanceof FormData||(n=JSON.stringify(n),a["Content-Type"]="application/json"),fetch("".concat(u).concat(t),{body:n,headers:a,method:i}).then(function(e){var n=e.headers,t=e.status;if(t<200||400<=t)throw new Error(t);switch((n.get("Content-Type")||"").split(";")[0]){case"text/plain":return e.arrayBuffer();case"application/json":return e.json();default:return e}})})},{key:"setAuthorization",value:function(e){e?this.authorization="Bearer ".concat(e):delete this.authorization,this.token=e}}])&&B(n.prototype,t),o&&B(n,o),e}());function V(e){return e?{type:g,payload:e}:function(e){return e({type:"USER/REFRESH_SESSION",payload:H.fetch({endpoint:"user"})}).catch(function(){})}}t("bo1M");var J=t("wcCE");var K={en:{NotFound:{description:"This is not the web page you're looking for.",goBack:"Take me back home"},Room:{Create:{title:"Create a room",flag:"Flag",name:"Name",peerLimit:"Peer limit",submit:"Create room"},joining:"Joining room...",welcome:'Welcome to: "%{name}"'},Rooms:{peers:"%{count}/%{limit} peers"},Org:{Nav:{createRoom:"Create room",customize:"Customize",manageUsers:"Manage students"},CTA:{copy:"Are you an academy manager/teacher?",button:"Try it now"},Request:{approve:"Approve",decline:"Decline"},Signup:{title:"Create an account",name:"Organization name",submit:"Create account"}},User:{audioInput:"Audio input",settings:"Settings",saveSettings:"Save settings",signIn:"Sign-In with google",videoInput:"Video input"}},es:{NotFound:{description:"Esta no es la página que estás buscando.",goBack:"Volver al inicio"},Room:{Create:{title:"Crear una sala",flag:"Bandera",name:"Nombre",peerLimit:"Límite de parcipantes",submit:"Crear sala"},joining:"Entrando en la sala...",welcome:'Bienvenido a: "%{name}"'},Rooms:{peers:"%{count}/%{limit} personas"},Org:{Nav:{createRoom:"Crear sala",customize:"Personalizar",manageUsers:"Estudiantes"},CTA:{copy:"Eres gestor(a)/profesor(a) de una academia?",button:"Pruébalo ahora"},Request:{approve:"Aprobar",decline:"Rechazar"},Signup:{title:"Crear una cuenta",name:"Nombre de la organización",submit:"Crear cuenta"}},User:{audioInput:"Entrada de audio",settings:"Preferencias",saveSettings:"Guardar preferencias",signIn:"Iniciar Sesión con google",videoInput:"Entrada de vídeo"}}},Y=Object.keys(K),Q={};Y.forEach(function(e){Q[e]=Object(J.recursive)(!0,K.en,K[e])});function X(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Z=Object(i.c)({hasLoaded:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case R:return!0;case C:return!1;default:return e}},id:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case R:return n.payload._id;case C:return"";default:return e}},isActive:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case R:return n.payload.isActive||!1;case C:return!1;default:return e}},isAdmin:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case R:return n.payload.isAdmin||!1;case C:return!1;default:return e}},isShowingCreateRoom:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case P:return!0;case S:case _:case C:return!1;default:return e}},isShowingUsers:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case A:return!0;case T:case C:return!1;default:return e}},isSigningup:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case x:return!0;case I:return!1;default:return e}},isUser:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case R:return n.payload.isUser||!1;case"ORG/REQUEST_ACCESS_FULFILLED":return!0;case C:return!1;default:return e}},name:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case R:return n.payload.name;case C:return"";default:return e}},pendingRequests:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length?arguments[1]:void 0;switch(n.type){case k:return n.payload.reduce(function(e,n){return e+(n.isRequest?1:0)},0);case j:return e-1;case C:return 0;default:return e}},rooms:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"ORG/FETCH_ROOMS_FULFILLED":return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case S:return[].concat(X(e),[n.payload]).sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case"ORG/REMOVE_ROOM_FULFILLED":return e.filter(function(e){return e.slug!==n.payload.slug});case C:return[];default:return e}},users:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case k:return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case j:return"approve"===n.payload.resolution?e.map(function(e){return e._id===n.payload.user?function(a){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){var n,t,o;n=a,o=r[t=e],t in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o})}return a}({},e,{isRequest:void 0}):e}):e.filter(function(e){return e._id!==n.payload.user});case C:return[];default:return e}}}),$=t("1339"),ee=t.n($);function ne(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var te=(new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.promises=[],this.getPromise=this.getPromise.bind(this),this.onKey=this.onKey.bind(this),this.onPointer=this.onPointer.bind(this),this.touches=ee()(window,{filtered:!0,preventSimulated:!1}).on("start",this.onPointer).on("end",this.onPointer),window.addEventListener("keydown",this.onKey,!1),window.addEventListener("keyup",this.onKey,!1)}var n,t,o;return n=e,(t=[{key:"getPromise",value:function(){var n=this.isReady,t=this.promises;return new Promise(function(e){n?e():t.push(e)})}},{key:"onFirstInteraction",value:function(){var e=this.promises;this.touches.disable(),window.removeEventListener("keydown",this.onKey),window.removeEventListener("keyup",this.onKey),this.isReady=!0,e.forEach(function(e){return e()})}},{key:"onKey",value:function(){this.onFirstInteraction()}},{key:"onPointer",value:function(){this.onFirstInteraction()}}])&&ne(n.prototype,t),o&&ne(n,o),e}())).getPromise;function oe(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(e){ae(n,e,t[e])})}return n}function ae(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function re(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ie=Object(i.c)({name:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case L:return n.payload.name;case W:return"";default:return e}},peers:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0;switch(t.type){case L:return e.forEach(function(e){return e.connection.destroy()}),t.payload.peers;case N:return[].concat(re(e),[t.payload.peer]);case M:return e.filter(function(e){var n=e.connection;return e.peer===t.payload.peer&&(n.destroy(),!0)});case U:return e.map(function(e){return e.peer===t.payload.peer?oe({},e,{pointer:t.payload.pointer}):e});case z:return e.forEach(function(e){var n=e.connection;e.peer===t.payload.peer&&n.signal(t.payload.signal)}),e;case G:return e.map(function(e){if(e.peer!==t.payload.peer)return e;var n=document.createElement("video");return n.srcObject=t.payload.stream,n.onloadedmetadata=function(){return te().then(function(){return n.play()})},oe({},e,{video:n})});case E:return e.forEach(function(e){e.connection.addStream(t.payload.stream)}),e;case W:return e.forEach(function(e){return e.connection.destroy()}),[];default:return e}},photos:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case L:return n.payload.photos;case q:return[].concat(re(e),[n.payload]);case D:return e.map(function(e){return e._id===n.payload.photo?oe({},e,{origin:{x:n.payload.origin.x,y:n.payload.origin.y}}):e});case F:return e.filter(function(e){return e._id!==n.payload.photo});case W:return[];default:return e}},socket:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case L:return n.payload.socket;case W:return!1;default:return e}}}),ce="BABELCHAT::",ue="".concat(ce,"SESSION"),se=JSON.parse(localStorage.getItem(ue)||"false");se&&H.setAuthorization(se.token);var le=Object(i.c)({isAudioMuted:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case O:return!e;default:return e}},isAuth:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!!se;switch((1<arguments.length?arguments[1]:void 0).type){case g:return!0;case y:case w:return!1;default:return e}},isShowingSettings:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch((1<arguments.length?arguments[1]:void 0).type){case m:return!1;case b:return!0;default:return e}},orgs:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"USER/FETCH_ORGS_FULFILLED":return n.payload.sort(function(e,n){var t=e.name,o=n.name;return t.localeCompare(o)});case w:return[];default:return e}},profile:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:se?se.profile:{},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case g:return n.payload.profile;case y:case w:return{};default:return e}},settings:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{audioInput:localStorage.getItem("".concat(ce,"audioInput"))||"",videoInput:localStorage.getItem("".concat(ce,"videoInput"))||""},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case v:var t=n.payload,o=t.audioInput,a=t.videoInput;return localStorage.setItem("".concat(ce,"audioInput"),o||""),localStorage.setItem("".concat(ce,"videoInput"),a||""),{audioInput:o,videoInput:a};default:return e}},stream:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case E:return n.payload.stream;case W:return e&&e.getTracks().forEach(function(e){return e.stop()}),!1;case O:return e&&e.getAudioTracks().forEach(function(e){e.enabled=!e.enabled}),e;default:return e}},token:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:se?se.token:"",n=1<arguments.length?arguments[1]:void 0;switch(n.type){case g:return H.setAuthorization(n.payload.token),localStorage.setItem(ue,JSON.stringify(n.payload)),n.payload.token;case y:case w:return H.setAuthorization(!1),localStorage.removeItem(ue),"";default:return e}},video:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case E:var t=document.createElement("video");return t.muted=!0,t.srcObject=n.payload.stream,t.onloadedmetadata=function(){return te().then(function(){return t.play()})},t;case W:return e&&(e.srcObject=null),!1;default:return e}}}),de=Object(i.c)({i18n:h.i18nReducer,loadingBar:s.loadingBarReducer,org:Z,room:ie,user:le}),pe=t("2INN"),me=t("mf+E"),fe=t("jKe7"),he=t("17x9"),ge=t.n(he),ye=t("vOnD"),ve=t("O1PE");function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ee(e,n){return!n||"object"!==be(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,n){return(Se=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Re=function(e){function t(e){var n;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ee(this,Oe(t).call(this,e))).dom=f.a.createRef(),n}var n,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Se(e,n)}(t,r["Component"]),n=t,(o=[{key:"componentDidMount",value:function(){var e=this.dom,n=this.props.video;e.current.appendChild(n)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.dom;return f.a.createElement("div",{ref:e})}}])&&we(n.prototype,o),a&&we(n,a),t}();Re.propTypes={video:ge.a.object.isRequired};var ke=Re,_e=ye.a.button.withConfig({displayName:"button",componentId:"sc-182fno4-0"})(["display:flex;align-items:center;justify-content:center;padding:0.5rem 1rem;margin:0;background-color:",";color:#eee;border:1px solid #151515;border-radius:2px;outline:0;font-family:inherit;font-size:inherit;font-weight:700;transition:background-color ease-out .2s;will-change:background-color;cursor:pointer;> span{margin-left:0.5rem;}&:hover{background-color:#393;}"],function(e){return e.primary?"#393":"#111"}),Ie=ye.a.div.withConfig({displayName:"dialog__Overlay",componentId:"r5l1bo-0"})(["position:fixed;top:0;left:0;bottom:0;width:100%;background:rgba(0,0,0,.75);z-index:100000;"]),Te=ye.a.div.withConfig({displayName:"dialog__Wrapper",componentId:"r5l1bo-1"})(["position:absolute;top:50%;left:50%;transform:translate(-50%,-75%);width:",";display:flex;flex-direction:column;border-radius:2px;"],function(e){return e.width}),je=ye.a.h2.withConfig({displayName:"dialog__Heading",componentId:"r5l1bo-2"})(["flex-shrink:0;display:flex;justify-content:space-between;align-items:center;height:40px;margin:0;font-size:1.25em;padding:0 1rem;background:#393;color:#eee;border-radius:2px 2px 0 0;> a{display:flex;text-decoration:none;font-size:1.5em;cursor:pointer;}"]),Ce=ye.a.div.withConfig({displayName:"dialog__Content",componentId:"r5l1bo-3"})(["padding:1rem;background:#eee;color:#353535;border-radius:0 0 2px 2px;"]),Pe=function(e){var n=e.children,t=e.title,o=e.width,a=e.hide;return f.a.createElement(Ie,null,f.a.createElement(Te,{width:o},f.a.createElement(je,null,f.a.createElement(h.Translate,{value:t}),f.a.createElement("a",{onClick:function(){return a()}},f.a.createElement(ve.TiTimes,null))),f.a.createElement(Ce,null,n)))};Pe.defaultProps={width:"400px"},Pe.propTypes={children:ge.a.node.isRequired,title:ge.a.string.isRequired,width:ge.a.string,hide:ge.a.func.isRequired};var xe=Pe,Ae=ye.a.form.withConfig({displayName:"form",componentId:"sc-1i7o20f-0"})(["> div{margin-top:0.5rem;text-align:left;&:first-child{margin-top:0;}> label{display:block;width:100%;font-weight:700;}> input,> select{display:block;font-family:inherit;box-sizing:border-box;width:100%;padding:0.5rem;cursor:pointer;border:1px solid #ccc;}> button{margin:1rem auto;padding:0.5rem 1rem;cursor:pointer;}}"]);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ue(e,n){return(Ue=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var ze=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Ne(a).call(this,e))||"object"!==qe(o)&&"function"!=typeof o?Me(t):o).onSubmit=n.onSubmit.bind(Me(n)),n.state={},n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Ue(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentDidMount",value:function(){var o=this;navigator.mediaDevices.enumerateDevices().then(function(e){var n=e.filter(function(e){return"audioinput"===e.kind}),t=e.filter(function(e){return"videoinput"===e.kind});o.setState({audioInputs:n,videoInputs:t})}).catch(function(){})}},{key:"onSubmit",value:function(e){var n=this.props,t=n.hide,o=n.save;e.preventDefault();var a=e.target;o({audioInput:a.audioInput.value,videoInput:a.videoInput.value}),t()}},{key:"render",value:function(){var e=this.props,n=e.settings,t=n.audioInput,o=n.videoInput,a=e.hide,r=this.state,i=r.audioInputs,c=r.videoInputs;return i&&c?f.a.createElement(xe,{title:"User.settings",hide:a},f.a.createElement(Ae,{onSubmit:this.onSubmit},f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"User.audioInput"})),f.a.createElement("select",{name:"audioInput",defaultValue:t},i.map(function(e){var n=e.deviceId,t=e.label;return f.a.createElement("option",{key:n,value:n},t)}))),f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"User.videoInput"})),f.a.createElement("select",{name:"videoInput",defaultValue:o},c.map(function(e){var n=e.deviceId,t=e.label;return f.a.createElement("option",{key:n,value:n},t)}))),f.a.createElement("div",{className:"submit"},f.a.createElement(_e,{type:"submit"},f.a.createElement(ve.TiTick,null),f.a.createElement(h.Translate,{value:"User.saveSettings"}))))):null}}])&&Le(n.prototype,t),o&&Le(n,o),a}();ze.propTypes={settings:ge.a.shape({audioInput:ge.a.string.isRequired,videoInput:ge.a.string.isRequired}).isRequired,hide:ge.a.func.isRequired,save:ge.a.func.isRequired};var Ge=Object(u.connect)(function(e){return{settings:e.user.settings}},{hide:function(){return{type:m}},save:function(e){var n=e.audioInput,t=e.videoInput;return{type:v,payload:{audioInput:n,videoInput:t}}}})(ze),De=ye.a.div.withConfig({displayName:"user__Wrapper",componentId:"wx5awn-0"})(["position:absolute;top:0;right:0;background:#000;box-shadow:0 0 10px rgba(0,0,0,.5);overflow:hidden;&,> img,> div > video{width:100px;height:100px;}> img{vertical-align:middle;}.actions{display:flex;position:absolute;bottom:-100%;width:100%;align-items:center;justify-content:space-between;font-size:2em;color:#eee;transition:bottom ease-out .2s;will-change:bottom;> a{cursor:pointer;&:hover{background:#eee;color:#333;}}}&:hover .actions{bottom:0;}"]),Fe=function(e){var n=e.isAudioMuted,t=e.isAuth,o=e.isShowingSettings,a=e.profile,r=e.video,i=e.showSettings,c=e.signout,u=e.toggleAudio;return t?f.a.createElement("div",null,f.a.createElement(De,null,r&&r.srcObject.getVideoTracks().length?f.a.createElement(ke,{video:r}):f.a.createElement("img",{src:"".concat(H.baseURL,"user/").concat(a._id,"/photo?auth=").concat(H.token)}),f.a.createElement("div",{className:"actions"},f.a.createElement("a",{onClick:u},n?f.a.createElement(ve.TiVolumeMute,null):f.a.createElement(ve.TiVolumeDown,null)),f.a.createElement("a",{onClick:i},f.a.createElement(ve.TiCog,null)),f.a.createElement("a",{onClick:c},f.a.createElement(ve.TiEject,null)))),o?f.a.createElement(Ge,null):null):null};Fe.propTypes={isAudioMuted:ge.a.bool.isRequired,isAuth:ge.a.bool.isRequired,isShowingSettings:ge.a.bool.isRequired,profile:ge.a.shape({_id:ge.a.string}).isRequired,video:ge.a.oneOfType([ge.a.bool,ge.a.object]).isRequired,showSettings:ge.a.func.isRequired,signout:ge.a.func.isRequired,toggleAudio:ge.a.func.isRequired};var We=Object(u.connect)(function(e){var n=e.user;return{isAudioMuted:n.isAudioMuted,isAuth:n.isAuth,isShowingSettings:n.isShowingSettings,profile:n.profile,video:n.video}},{showSettings:function(){return{type:b}},signout:function(){return{type:w}},toggleAudio:function(){return{type:O}}})(Fe),Be=ye.a.div.withConfig({displayName:"layout__Route",componentId:"wopef3-0"})(["display:flex;height:100vh;"]),He={backgroundColor:"#393",zIndex:1},Ve=function(e){var n=e.children;return f.a.createElement("div",null,f.a.createElement(l.a,{style:He}),f.a.createElement(Be,null,n),f.a.createElement(We,null))};Ve.propTypes={children:ge.a.node.isRequired};var Je=Ve,Ke=t("2iEm");function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qe(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e,n){return($e=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var en=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Xe(a).call(this,e))||"object"!==Ye(o)&&"function"!=typeof o?Ze(t):o).loginWithGoogle=n.loginWithGoogle.bind(Ze(n)),n.onMessage=n.onMessage.bind(Ze(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&$e(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentWillUnmount",value:function(){var e=this.popupWatcher;e&&(window.removeEventListener("message",this.onMessage),clearInterval(e),delete this.popupWatcher)}},{key:"onMessage",value:function(e){var n=e.origin,t=e.data.session,o=this.popupWatcher,a=this.props,r=a.onSession,i=a.refreshSession;0===H.baseURL.indexOf(n)&&(window.removeEventListener("message",this.onMessage),clearInterval(o),delete this.popupWatcher,t&&(i(t),r&&r(t)))}},{key:"loginWithGoogle",value:function(e){var n=this,t=e.screenX,o=e.screenY,a=(t||window.screen.width/2)-256,r=(o||window.screen.height/2)-256,i=window.open("".concat(H.baseURL,"user/google"),"loginWithGoogle","width=".concat(512,",height=").concat(512,",top=").concat(r,",left=").concat(a));this.popupWatcher&&(window.removeEventListener("message",this.onMessage),clearInterval(this.popupWatcher)),this.popupWatcher=setInterval(function(){if(!i.window)return clearInterval(n.popupWatcher),void delete n.popupWatcher;i.postMessage(!0,H.baseURL)},100),window.addEventListener("message",this.onMessage,!1)}},{key:"render",value:function(){var e=this.props,n=e.icon,t=e.label;return f.a.createElement(_e,{type:"button",onClick:this.loginWithGoogle},f.a.createElement(n,null),f.a.createElement(h.Translate,{value:t}))}}])&&Qe(n.prototype,t),o&&Qe(n,o),a}();en.defaultProps={icon:ve.TiSocialGooglePlus,label:"User.signIn",onSession:void 0},en.propTypes={icon:ge.a.func,label:ge.a.string,onSession:ge.a.func,refreshSession:ge.a.func.isRequired};var nn=Object(u.connect)(function(){return{}},{refreshSession:V})(en),tn=ye.a.div.withConfig({displayName:"page__Scroll",componentId:"sc-2p96wn-0"})(["display:flex;width:100%;overflow-y:overlay;"]),on=ye.a.div.withConfig({displayName:"page__Wrapper",componentId:"sc-2p96wn-1"})(["display:flex;width:100%;max-width:1024px;flex-direction:column;background:#fff;margin:0 auto;box-shadow:0 0 150px rgba(0,0,0,.15);"]),an=function(e){var n=e.children,t=e.className;return f.a.createElement(tn,null,f.a.createElement(on,{className:t},n))};an.defaultProps={className:null},an.propTypes={children:ge.a.oneOfType([ge.a.element,ge.a.arrayOf(ge.a.element)]).isRequired,className:ge.a.string};var rn=an;function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function un(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ln(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e,n){return(dn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var pn=ye.a.div.withConfig({displayName:"landing__Heading",componentId:"sc-8xfovt-0"})(["display:flex;flex-shrink:0;flex-direction:column;align-items:center;justify-content:center;background:#222;height:300px;> h2{color:#fff;font-size:3em;margin:0 0 1.5rem;}> p{color:#eee;margin:0;font-size:1.5em;}"]),mn=ye.a.div.withConfig({displayName:"landing__Grid",componentId:"sc-8xfovt-1"})(["display:flex;height:100%;> div,> ul{&:nth-child(1){width:60%;}&:nth-child(2){width:40%;}}"]),fn=ye.a.div.withConfig({displayName:"landing__Orgs",componentId:"sc-8xfovt-2"})(["background:#eee;> h3{margin:0;font-size:1.5em;color:#666;padding:1.5rem 1.5rem 1rem;border-bottom:1px solid #ddd;}> a{display:flex;box-sizing:border-box;width:100%;align-items:center;justify-content:space-between;font-size:1.5em;padding:0.75rem 1.5rem;color:#000;text-decoration:none;transition:color ease-out .15s,background-color ease-out .15s;will-change:color,background-color;&:nth-child(odd){background:#ddd;}&.full{opacity:0.5;pointer-events:none;}> strong > img{width:1.5rem;height:1.125rem;margin-right:1rem;vertical-align:middle;}&:hover{color:#eee;background-color:#393;}}> button{margin:1.5rem auto;> svg{font-size:2em;}}"]),hn=ye.a.ul.withConfig({displayName:"landing__Features",componentId:"sc-8xfovt-3"})(["margin:2rem 1rem;text-align:left;> li{padding:0.5rem 0.5rem;font-size:1.5em;}"]),gn=ye.a.div.withConfig({displayName:"landing__CTA",componentId:"sc-8xfovt-4"})(["margin-top:auto;padding:1rem 0 2rem;background:#393;color:#eee;> p{font-size:1.5em;text-align:center;}> button{margin:0 auto;font-size:2em;padding:1rem 2rem;}"]),yn=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=sn(a).call(this,e))||"object"!==cn(o)&&"function"!=typeof o?ln(t):o).onSubmit=n.onSubmit.bind(ln(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&dn(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"componentWillMount",value:function(){var e=this.props,n=e.fetchOrgs;e.isAuth&&n()}},{key:"componentDidUpdate",value:function(e){var n=e.isAuth,t=this.props,o=t.isAuth,a=t.fetchOrgs;!n&&o&&a()}},{key:"onSubmit",value:function(e){var n=this.props,t=n.hideSignup,o=n.history,a=n.signup,r=e.target;e.preventDefault();var i=r.name.value;i&&a({name:i}).then(function(e){var n=e.value;return o.push("/".concat(n))}).catch(function(){}).finally(t)}},{key:"render",value:function(){var e=this.props,n=e.hideSignup,t=e.isAuth,o=e.isSigningup,a=e.orgs,r=e.showSignup;return f.a.createElement(rn,null,f.a.createElement(pn,null,f.a.createElement("h2",null,"BabelChat"),f.a.createElement("p",null,"Create your own language exchange service in seconds")),f.a.createElement(mn,null,f.a.createElement(hn,null,f.a.createElement("li",null,"1 to 1 conversations with students"),f.a.createElement("li",null,"Group videochat rooms (up to 8 peers)"),f.a.createElement("li",null,"Whiteboard with drag&drop image sharing"),f.a.createElement("li",null,"Customize it with your own branding"),f.a.createElement("li",null,"Integrate it onto your website"),f.a.createElement("li",null,"Free unlimited rooms/students while in open alpha")),f.a.createElement(fn,null,f.a.createElement("h3",null,"Your orgs"),t?a.map(function(e){var n=e.name,t=e.slug;return f.a.createElement(Ke.a,{key:t,to:{pathname:"/".concat(t)}},n)}):f.a.createElement(nn,null))),f.a.createElement(gn,null,f.a.createElement("p",null,f.a.createElement(h.Translate,{value:"Org.CTA.copy"})),t?f.a.createElement(_e,{type:"button",onClick:r},f.a.createElement(ve.TiGroup,null),f.a.createElement(h.Translate,{value:"Org.CTA.button"})):f.a.createElement(nn,{icon:ve.TiGroup,label:"Org.CTA.button",onSession:r})),o?f.a.createElement(xe,{title:"Org.Signup.title",hide:n},f.a.createElement(Ae,{onSubmit:this.onSubmit},f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"Org.Signup.name"})),f.a.createElement("input",{type:"text",name:"name"})),f.a.createElement("div",{className:"submit"},f.a.createElement(_e,{type:"submit"},f.a.createElement(ve.TiPlus,null),f.a.createElement(h.Translate,{value:"Org.Signup.submit"}))))):null)}}])&&un(n.prototype,t),o&&un(n,o),a}();yn.propTypes={history:ge.a.object.isRequired,isAuth:ge.a.bool.isRequired,isSigningup:ge.a.bool.isRequired,orgs:ge.a.arrayOf(ge.a.shape({name:ge.a.string.isRequired,slug:ge.a.string.isRequired})).isRequired,fetchOrgs:ge.a.func.isRequired,hideSignup:ge.a.func.isRequired,showSignup:ge.a.func.isRequired,signup:ge.a.func.isRequired};var vn=Object(u.connect)(function(e){var n=e.org.isSigningup,t=e.user;return{isAuth:t.isAuth,isSigningup:n,orgs:t.orgs}},{fetchOrgs:function(){return{type:"USER/FETCH_ORGS",payload:H.fetch({endpoint:"user/orgs"})}},hideSignup:function(){return{type:I}},showSignup:function(){return{type:x}},signup:function(e){var n=e.name;return{type:"ORG/SIGNUP",payload:H.fetch({body:{name:n},endpoint:"orgs",method:"PUT"})}}})(yn),bn=ye.a.div.withConfig({displayName:"sc-404__Wrapper",componentId:"ga9xrh-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;justify-content:center;"]),wn=ye.a.div.withConfig({displayName:"sc-404__Status",componentId:"ga9xrh-1"})(["font-size:6em;line-height:0.8em;color:#656565;margin-bottom:2rem;"]),En=ye.a.div.withConfig({displayName:"sc-404__Description",componentId:"ga9xrh-2"})(["font-size:1.5em;"]),On=ye.a.div.withConfig({displayName:"sc-404__Alternative",componentId:"ga9xrh-3"})(["margin:2rem 0 4rem;> a{text-decoration:none;font-size:1.2em;}"]),Sn=function(){return f.a.createElement(bn,null,f.a.createElement(wn,null,"404"),f.a.createElement(En,null,f.a.createElement(h.Translate,{value:"NotFound.description"})),f.a.createElement(On,null,f.a.createElement(Ke.a,{to:{pathname:"/"}},f.a.createElement(_e,{type:"button",primary:!0},f.a.createElement(ve.TiArrowBack,null),f.a.createElement(h.Translate,{value:"NotFound.goBack"})))))},Rn=[{name:"Afghanistan",code:"af"},{name:"Åland Islands",code:"ax"},{name:"Albania",code:"al"},{name:"Algeria",code:"dz"},{name:"American Samoa",code:"as"},{name:"Andorra",code:"ad"},{name:"Angola",code:"ao"},{name:"Anguilla",code:"ai"},{name:"Antarctica",code:"aq"},{name:"Antigua and Barbuda",code:"ag"},{name:"Argentina",code:"ar"},{name:"Armenia",code:"am"},{name:"Aruba",code:"aw"},{name:"Australia",code:"au"},{name:"Austria",code:"at"},{name:"Azerbaijan",code:"az"},{name:"Bahamas",code:"bs"},{name:"Bahrain",code:"bh"},{name:"Bangladesh",code:"bd"},{name:"Barbados",code:"bb"},{name:"Belarus",code:"by"},{name:"Belgium",code:"be"},{name:"Belize",code:"bz"},{name:"Benin",code:"bj"},{name:"Bermuda",code:"bm"},{name:"Bhutan",code:"bt"},{name:"Bolivia, Plurinational State of",code:"bo"},{name:"Bonaire, Sint Eustatius and Saba",code:"bq"},{name:"Bosnia and Herzegovina",code:"ba"},{name:"Botswana",code:"bw"},{name:"Bouvet Island",code:"bv"},{name:"Brazil",code:"br"},{name:"British Indian Ocean Territory",code:"io"},{name:"Brunei Darussalam",code:"bn"},{name:"Bulgaria",code:"bg"},{name:"Burkina Faso",code:"bf"},{name:"Burundi",code:"bi"},{name:"Cambodia",code:"kh"},{name:"Cameroon",code:"cm"},{name:"Canada",code:"ca"},{name:"Cape Verde",code:"cv"},{name:"Catalonia",code:"es-ct"},{name:"Cayman Islands",code:"ky"},{name:"Central African Republic",code:"cf"},{name:"Chad",code:"td"},{name:"Chile",code:"cl"},{name:"China",code:"cn"},{name:"Christmas Island",code:"cx"},{name:"Cocos (Keeling) Islands",code:"cc"},{name:"Colombia",code:"co"},{name:"Comoros",code:"km"},{name:"Congo",code:"cg"},{name:"Congo, the Democratic Republic of the",code:"cd"},{name:"Cook Islands",code:"ck"},{name:"Costa Rica",code:"cr"},{name:"Côte d'Ivoire",code:"ci"},{name:"Croatia",code:"hr"},{name:"Cuba",code:"cu"},{name:"Curaçao",code:"cw"},{name:"Cyprus",code:"cy"},{name:"Czech Republic",code:"cz"},{name:"Denmark",code:"dk"},{name:"Djibouti",code:"dj"},{name:"Dominica",code:"dm"},{name:"Dominican Republic",code:"do"},{name:"Ecuador",code:"ec"},{name:"Egypt",code:"eg"},{name:"El Salvador",code:"sv"},{name:"Equatorial Guinea",code:"gq"},{name:"Eritrea",code:"er"},{name:"Estonia",code:"ee"},{name:"Ethiopia",code:"et"},{name:"European Union",code:"eu"},{name:"Falkland Islands (Malvinas)",code:"fk"},{name:"Faroe Islands",code:"fo"},{name:"Fiji",code:"fj"},{name:"Finland",code:"fi"},{name:"France",code:"fr"},{name:"French Guiana",code:"gf"},{name:"French Polynesia",code:"pf"},{name:"French Southern Territories",code:"tf"},{name:"Gabon",code:"ga"},{name:"Gambia",code:"gm"},{name:"Georgia",code:"ge"},{name:"Germany",code:"de"},{name:"Ghana",code:"gh"},{name:"Gibraltar",code:"gi"},{name:"Greece",code:"gr"},{name:"Greenland",code:"gl"},{name:"Grenada",code:"gd"},{name:"Guadeloupe",code:"gp"},{name:"Guam",code:"gu"},{name:"Guatemala",code:"gt"},{name:"Guernsey",code:"gg"},{name:"Guinea",code:"gn"},{name:"Guinea-Bissau",code:"gw"},{name:"Guyana",code:"gy"},{name:"Haiti",code:"ht"},{name:"Heard Island and McDonald Islands",code:"hm"},{name:"Holy See (Vatican City State)",code:"va"},{name:"Honduras",code:"hn"},{name:"Hong Kong",code:"hk"},{name:"Hungary",code:"hu"},{name:"Iceland",code:"is"},{name:"India",code:"in"},{name:"Indonesia",code:"id"},{name:"Iran, Islamic Republic of",code:"ir"},{name:"Iraq",code:"iq"},{name:"Ireland",code:"ie"},{name:"Isle of Man",code:"im"},{name:"Israel",code:"il"},{name:"Italy",code:"it"},{name:"Jamaica",code:"jm"},{name:"Japan",code:"jp"},{name:"Jersey",code:"je"},{name:"Jordan",code:"jo"},{name:"Kazakhstan",code:"kz"},{name:"Kenya",code:"ke"},{name:"Kiribati",code:"ki"},{name:"Korea, Democratic People's Republic of",code:"kp"},{name:"Korea, Republic of",code:"kr"},{name:"Kuwait",code:"kw"},{name:"Kyrgyzstan",code:"kg"},{name:"Lao People's Democratic Republic",code:"la"},{name:"Latvia",code:"lv"},{name:"Lebanon",code:"lb"},{name:"Lesotho",code:"ls"},{name:"Liberia",code:"lr"},{name:"Libya",code:"ly"},{name:"Liechtenstein",code:"li"},{name:"Lithuania",code:"lt"},{name:"Luxembourg",code:"lu"},{name:"Macao",code:"mo"},{name:"Macedonia, the Former Yugoslav Republic of",code:"mk"},{name:"Madagascar",code:"mg"},{name:"Malawi",code:"mw"},{name:"Malaysia",code:"my"},{name:"Maldives",code:"mv"},{name:"Mali",code:"ml"},{name:"Malta",code:"mt"},{name:"Marshall Islands",code:"mh"},{name:"Martinique",code:"mq"},{name:"Mauritania",code:"mr"},{name:"Mauritius",code:"mu"},{name:"Mayotte",code:"yt"},{name:"Mexico",code:"mx"},{name:"Micronesia, Federated States of",code:"fm"},{name:"Moldova, Republic of",code:"md"},{name:"Monaco",code:"mc"},{name:"Mongolia",code:"mn"},{name:"Montenegro",code:"me"},{name:"Montserrat",code:"ms"},{name:"Morocco",code:"ma"},{name:"Mozambique",code:"mz"},{name:"Myanmar",code:"mm"},{name:"Namibia",code:"na"},{name:"Nauru",code:"nr"},{name:"Nepal",code:"np"},{name:"Netherlands",code:"nl"},{name:"New Caledonia",code:"nc"},{name:"New Zealand",code:"nz"},{name:"Nicaragua",code:"ni"},{name:"Niger",code:"ne"},{name:"Nigeria",code:"ng"},{name:"Niue",code:"nu"},{name:"Norfolk Island",code:"nf"},{name:"Northern Mariana Islands",code:"mp"},{name:"Norway",code:"no"},{name:"Oman",code:"om"},{name:"Pakistan",code:"pk"},{name:"Palau",code:"pw"},{name:"Palestine, State of",code:"ps"},{name:"Panama",code:"pa"},{name:"Papua New Guinea",code:"pg"},{name:"Paraguay",code:"py"},{name:"Peru",code:"pe"},{name:"Philippines",code:"ph"},{name:"Pitcairn",code:"pn"},{name:"Poland",code:"pl"},{name:"Portugal",code:"pt"},{name:"Puerto Rico",code:"pr"},{name:"Qatar",code:"qa"},{name:"Réunion",code:"re"},{name:"Romania",code:"ro"},{name:"Russian Federation",code:"ru"},{name:"Rwanda",code:"rw"},{name:"Saint Barthélemy",code:"bl"},{name:"Saint Helena, Ascension and Tristan da Cunha",code:"sh"},{name:"Saint Kitts and Nevis",code:"kn"},{name:"Saint Lucia",code:"lc"},{name:"Saint Martin (French part)",code:"mf"},{name:"Saint Pierre and Miquelon",code:"pm"},{name:"Saint Vincent and the Grenadines",code:"vc"},{name:"Samoa",code:"ws"},{name:"San Marino",code:"sm"},{name:"Sao Tome and Principe",code:"st"},{name:"Saudi Arabia",code:"sa"},{name:"Senegal",code:"sn"},{name:"Serbia",code:"rs"},{name:"Seychelles",code:"sc"},{name:"Sierra Leone",code:"sl"},{name:"Singapore",code:"sg"},{name:"Sint Maarten (Dutch part)",code:"sx"},{name:"Slovakia",code:"sk"},{name:"Slovenia",code:"si"},{name:"Solomon Islands",code:"sb"},{name:"Somalia",code:"so"},{name:"South Africa",code:"za"},{name:"South Georgia and the South Sandwich Islands",code:"gs"},{name:"South Sudan",code:"ss"},{name:"Spain",code:"es"},{name:"Sri Lanka",code:"lk"},{name:"Sudan",code:"sd"},{name:"Suriname",code:"sr"},{name:"Svalbard and Jan Mayen",code:"sj"},{name:"Swaziland",code:"sz"},{name:"Sweden",code:"se"},{name:"Switzerland",code:"ch"},{name:"Syrian Arab Republic",code:"sy"},{name:"Taiwan, Province of China",code:"tw"},{name:"Tajikistan",code:"tj"},{name:"Tanzania, United Republic of",code:"tz"},{name:"Thailand",code:"th"},{name:"Timor-Leste",code:"tl"},{name:"Togo",code:"tg"},{name:"Tokelau",code:"tk"},{name:"Tonga",code:"to"},{name:"Trinidad and Tobago",code:"tt"},{name:"Tunisia",code:"tn"},{name:"Turkey",code:"tr"},{name:"Turkmenistan",code:"tm"},{name:"Turks and Caicos Islands",code:"tc"},{name:"Tuvalu",code:"tv"},{name:"Uganda",code:"ug"},{name:"Ukraine",code:"ua"},{name:"United Arab Emirates",code:"ae"},{name:"United Kingdom",code:"gb"},{name:"England",code:"gb-eng"},{name:"Northern Ireland",code:"gb-nir"},{name:"Scotland",code:"gb-sct"},{name:"Wales",code:"gb-wls"},{name:"United Nations",code:"un"},{name:"United States",code:"us"},{name:"United States Minor Outlying Islands",code:"um"},{name:"Uruguay",code:"uy"},{name:"Uzbekistan",code:"uz"},{name:"Vanuatu",code:"vu"},{name:"Venezuela, Bolivarian Republic of",code:"ve"},{name:"Viet Nam",code:"vn"},{name:"Virgin Islands, British",code:"vg"},{name:"Virgin Islands, U.S.",code:"vi"},{name:"Wallis and Futuna",code:"wf"},{name:"Western Sahara",code:"eh"},{name:"Yemen",code:"ye"},{name:"Zambia",code:"zm"},{name:"Zimbabwe",code:"zw"}];function kn(e){return(kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function In(e){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jn(e,n){return(jn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Cn=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=In(a).call(this,e))||"object"!==kn(o)&&"function"!=typeof o?Tn(t):o).onSubmit=n.onSubmit.bind(Tn(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&jn(e,n)}(a,r["PureComponent"]),n=a,(t=[{key:"onSubmit",value:function(e){var n=this.props.createRoom,t=e.target;e.preventDefault();var o=t.flag.value,a=t.name.value,r=parseInt(t.peerLimit.value,10);o&&a&&r&&n({flag:o,name:a,peerLimit:r})}},{key:"render",value:function(){var e=this.props,n=e.isShowingCreateRoom,t=e.hide;return n?f.a.createElement(xe,{title:"Room.Create.title",hide:t},f.a.createElement(Ae,{onSubmit:this.onSubmit},f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"Room.Create.name"})),f.a.createElement("input",{type:"text",name:"name"})),f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"Room.Create.flag"})),f.a.createElement("select",{name:"flag",defaultValue:"gb"},Rn.map(function(e){var n=e.code,t=e.name;return f.a.createElement("option",{value:n},t)}))),f.a.createElement("div",null,f.a.createElement("label",null,f.a.createElement(h.Translate,{value:"Room.Create.peerLimit"})),f.a.createElement("input",{type:"number",name:"peerLimit",min:"2",max:"8",defaultValue:"8"})),f.a.createElement("div",{className:"submit"},f.a.createElement(_e,{type:"submit"},f.a.createElement(ve.TiPlus,null),f.a.createElement(h.Translate,{value:"Room.Create.submit"}))))):null}}])&&_n(n.prototype,t),o&&_n(n,o),a}();Cn.propTypes={isShowingCreateRoom:ge.a.bool.isRequired,createRoom:ge.a.func.isRequired,hide:ge.a.func.isRequired};var Pn=Object(u.connect)(function(e){return{isShowingCreateRoom:e.org.isShowingCreateRoom}},{createRoom:function(e){var o=e.flag,a=e.name,r=e.peerLimit;return function(e,n){var t=n().org.id;return e({type:"ORG/CREATE_ROOM",payload:H.fetch({body:{flag:o,name:a,peerLimit:r},endpoint:"org/".concat(t,"/rooms"),method:"PUT"})})}},hide:function(){return{type:_}}})(Cn);function xn(e){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function An(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function qn(e,n){return!n||"object"!==xn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function Ln(e){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nn(e,n){return(Nn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Mn=ye.a.div.withConfig({displayName:"rooms__Listing",componentId:"j6zg2b-0"})(["display:flex;flex-direction:column;align-items:center;> a{display:flex;box-sizing:border-box;width:100%;align-items:center;justify-content:space-between;font-size:1.5em;padding:1rem;color:#000;text-decoration:none;transition:color ease-out .15s,background-color ease-out .15s;will-change:color,background-color;&:nth-child(even){background:#ddd;}&.full{opacity:0.5;pointer-events:none;}> strong > img{width:1.5rem;height:1.125rem;margin-right:1rem;vertical-align:middle;}&:hover{color:#eee;background-color:#393;}}&.admin > a{> svg{display:none;}&:hover{> span{display:none;}> svg{display:block;}}}"]),Un=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),qn(this,Ln(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Nn(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentDidMount",value:function(){(0,this.props.fetch)()}},{key:"onRemove",value:function(e,n){var t=this.props.removeRoom;e.preventDefault(),t(n)}},{key:"render",value:function(){var i=this,e=this.props,c=e.isAdmin,n=e.list,u=e.org;return f.a.createElement(Mn,{className:c?"admin":null},n.map(function(e){var n=e.flag,t=e.name,o=e.peerLimit,a=e.peers,r=e.slug;return f.a.createElement(Ke.a,{key:r,to:{pathname:"/".concat(u,"/").concat(r)},className:o<=a?"full":""},f.a.createElement("strong",null,f.a.createElement("img",{src:"".concat("https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/flags/4x3/").concat(n,".svg")}),t),f.a.createElement(h.Translate,{count:a,limit:o,value:"Rooms.peers"}),c?f.a.createElement(ve.TiTrash,{onClick:function(e){return i.onRemove(e,r)}}):null)}))}}])&&An(t.prototype,o),a&&An(t,a),n}();Un.propTypes={isAdmin:ge.a.bool.isRequired,list:ge.a.arrayOf(ge.a.shape({flag:ge.a.string.isRequired,name:ge.a.string.isRequired,peerLimit:ge.a.number.isRequired,peers:ge.a.number.isRequired,slug:ge.a.string.isRequired})).isRequired,org:ge.a.string.isRequired,fetch:ge.a.func.isRequired,removeRoom:ge.a.func.isRequired};var zn=Object(u.connect)(function(e){var n=e.org;return{isAdmin:n.isAdmin,list:n.rooms}},{fetch:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/FETCH_ROOMS",payload:H.fetch({endpoint:"org/".concat(t,"/rooms")})})}},removeRoom:function(o){return function(e,n){var t=n().org.id;return e({type:"ORG/REMOVE_ROOM",payload:H.fetch({endpoint:"org/".concat(t,"/room/").concat(o),method:"DELETE"}).then(function(){return{slug:o}})})}}})(Un);function Gn(e){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Fn(e,n){return!n||"object"!==Gn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function Wn(e){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bn(e,n){return(Bn=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var Hn=ye.a.div.withConfig({displayName:"users__Scroll",componentId:"sc-1u1f4yo-0"})(["max-height:400px;overflow-y:auto;"]),Vn=ye.a.div.withConfig({displayName:"users__User",componentId:"sc-1u1f4yo-1"})(["display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:0.5rem;&:last-child{margin-bottom:0;}> div{display:flex;align-items:center;> button{margin-left:0.5rem;}> img{width:32px;height:32px;border-radius:16px;margin-right:0.5rem;vertical-align:middle;}}"]),Jn=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Fn(this,Wn(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Bn(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentDidMount",value:function(){(0,this.props.fetch)()}},{key:"render",value:function(){var e=this.props,n=e.list,t=e.isShowingUsers,o=e.hide,a=e.resolveRequest;return t?f.a.createElement(xe,{title:"Org.Nav.manageUsers",width:"512px",hide:o},f.a.createElement(Hn,null,n.map(function(e){var n=e._id,t=e.isRequest,o=e.name;return f.a.createElement(Vn,{key:n},f.a.createElement("div",null,f.a.createElement("img",{src:"".concat(H.baseURL,"user/").concat(n,"/photo?auth=").concat(H.token)}),o),t?f.a.createElement("div",null,f.a.createElement(_e,{type:"button",onClick:function(){return a({user:n,resolution:"decline"})}},f.a.createElement(ve.TiTimes,null),f.a.createElement(h.Translate,{value:"Org.Request.decline"})),f.a.createElement(_e,{type:"button",onClick:function(){return a({user:n,resolution:"approve"})},primary:!0},f.a.createElement(ve.TiTick,null),f.a.createElement(h.Translate,{value:"Org.Request.approve"}))):null)}))):null}}])&&Dn(t.prototype,o),a&&Dn(t,a),n}();Jn.propTypes={isShowingUsers:ge.a.bool.isRequired,list:ge.a.arrayOf(ge.a.shape({_id:ge.a.string.isRequired,isRequest:ge.a.bool,name:ge.a.string.isRequired})).isRequired,hide:ge.a.func.isRequired,fetch:ge.a.func.isRequired,resolveRequest:ge.a.func.isRequired};var Kn=Object(u.connect)(function(e){var n=e.org;return{isShowingUsers:n.isShowingUsers,list:n.users}},{hide:function(){return{type:T}},fetch:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/FETCH_USERS",payload:H.fetch({endpoint:"org/".concat(t,"/users")})})}},resolveRequest:function(e){var o=e.user,a=e.resolution;return function(e,n){var t=n().org.id;return e({type:"ORG/RESOLVE_REQUEST",payload:H.fetch({endpoint:"org/".concat(t,"/user/").concat(o,"/").concat(a),method:"POST"}).then(function(){return{user:o,resolution:a}})})}}})(Jn);function Yn(e){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],o=!0,a=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Xn(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Zn(e,n){return!n||"object"!==Yn(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,n){return(et=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var nt=Object(ye.a)(rn).withConfig({displayName:"org__Layout",componentId:"lwp656-0"})(["flex-direction:row;> div{box-sizing:border-box;flex-shrink:0;}"]),tt=ye.a.div.withConfig({displayName:"org__Nav",componentId:"lwp656-1"})(["display:flex;width:",";flex-direction:column;align-items:center;padding:1rem;background:#222;color:#eee;"],"212px"),ot=ye.a.div.withConfig({displayName:"org__Content",componentId:"lwp656-2"})(["width:calc(100% - ",");display:flex;flex-direction:column;"],"212px"),at="\n  > button {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 0.25rem;\n    display: flex;\n    font-size: 1.5em;\n    border-radius: 2px 0 0 0;\n    opacity: 0;\n    transition: opacity ease-out .2s;\n  }\n  &:hover > button {\n    opacity: 1;    \n  }\n",rt=ye.a.div.withConfig({displayName:"org__Logo",componentId:"lwp656-3"})(["position:relative;> img{width:180px;height:180px;background:#000;overflow:hidden;vertical-align:middle;}",""],at),it=ye.a.div.withConfig({displayName:"org__Name",componentId:"lwp656-4"})(["width:100%;font-size:1.666em;padding:1rem 0 0.5rem;"]),ct=ye.a.div.withConfig({displayName:"org__Url",componentId:"lwp656-5"})(["width:100%;padding:0 0 1.5rem;color:#aaa;user-select:all;"]),ut=ye.a.div.withConfig({displayName:"org__Actions",componentId:"lwp656-6"})(["width:100%;display:flex;flex-direction:column;align-items:center;> button{width:100%;margin:0 0 0.5rem;justify-content:flex-start;> svg{font-size:1.5em;margin-right:0.25rem;}.count{display:flex;margin-left:auto;align-items:center;justify-content:center;width:18px;height:18px;background-color:#393;border-radius:9px;font-size:0.85em;line-height:1em;transition:background-color ease-out .2s;will-change:background-color;transform:translate(25%,0);}&:hover .count{background-color:#111;}}"]),st=ye.a.div.withConfig({displayName:"org__Cover",componentId:"lwp656-7"})(["flex-shrink:0;background:#000;background-repeat:no-repeat;background-size:cover;background-image:url(",");width:100%;height:312px;position:relative;",""],function(e){return e.cover},at),lt=ye.a.div.withConfig({displayName:"org__Section",componentId:"lwp656-8"})(["display:flex;flex-direction:column;align-items:center;padding:3rem 0;> p{font-size:1.5rem;color:#666;}> button > svg{font-size:2em;}"]),dt=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Zn(this,$n(n).apply(this,arguments))}var t,o,a;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&et(e,n)}(n,r["PureComponent"]),t=n,(o=[{key:"componentWillMount",value:function(){this.fetch()}},{key:"componentDidUpdate",value:function(e){e.isAuth!==this.props.isAuth&&this.fetch()}},{key:"componentWillUnmount",value:function(){(0,this.props.reset)()}},{key:"fetch",value:function(){var e=this.props,n=e.match.params.slug,t=e.fetch,o=e.history;t(n).catch(function(){return o.replace("404")})}},{key:"updateImage",value:function(n){var t=this.props.updateImage,o=document.createElement("input");o.accept="image/*",o.type="file",o.onchange=function(){var e=Qn(o.files,1)[0];e&&t({image:n,blob:e}).then(function(){return window.location.reload()})},o.click()}},{key:"render",value:function(){var e=this,n=this.props,t=n.hasLoaded,o=n.id,a=n.isActive,r=n.isAdmin,i=n.isAuth,c=n.isUser,u=n.requestAccess,s=n.match.params.slug,l=n.name,d=n.pendingRequests,p=n.showCreateRoom,m=n.showUsers;return t?f.a.createElement(nt,null,f.a.createElement(tt,null,f.a.createElement(rt,null,f.a.createElement("img",{src:"".concat(H.baseURL,"org/").concat(o,"/logo")}),r?f.a.createElement(_e,{type:"button",onClick:function(){return e.updateImage("logo")}},f.a.createElement(ve.TiUpload,null)):null),f.a.createElement(it,null,l),f.a.createElement(ct,null,"".concat("babelchat.tk").concat("/").concat(s)),r?f.a.createElement(ut,null,f.a.createElement(_e,{type:"button",onClick:m},f.a.createElement(ve.TiGroup,null),f.a.createElement(h.Translate,{value:"Org.Nav.manageUsers"}),0<d?f.a.createElement("span",{className:"count"},d):null),f.a.createElement(_e,{type:"button",onClick:p},f.a.createElement(ve.TiMessages,null),f.a.createElement(h.Translate,{value:"Org.Nav.createRoom"}))):null),f.a.createElement(ot,null,f.a.createElement(st,{cover:"".concat(H.baseURL,"org/").concat(o,"/cover")},r?f.a.createElement(_e,{type:"button",onClick:function(){return e.updateImage("cover")}},f.a.createElement(ve.TiUpload,null)):null),c&&a?f.a.createElement(zn,{org:s}):null,c&&!a?f.a.createElement(lt,null,f.a.createElement("p",null,"Your account is pending approval")):null,i&&!c?f.a.createElement(lt,null,f.a.createElement("p",null,"Your are not a student of this organization"),f.a.createElement(_e,{type:"button",onClick:u},"Request access")):null,i?null:f.a.createElement(lt,null,f.a.createElement("p",null,"Welcome, please sign-in:"),f.a.createElement(nn,null)),r?f.a.createElement("div",null,f.a.createElement(Pn,null),f.a.createElement(Kn,null)):null)):null}}])&&Xn(t.prototype,o),a&&Xn(t,a),n}();dt.propTypes={match:ge.a.shape({params:ge.a.shape({slug:ge.a.string.isRequired}).isRequired}).isRequired,hasLoaded:ge.a.bool.isRequired,history:ge.a.object.isRequired,id:ge.a.string.isRequired,isActive:ge.a.bool.isRequired,isAdmin:ge.a.bool.isRequired,isAuth:ge.a.bool.isRequired,isUser:ge.a.bool.isRequired,name:ge.a.string.isRequired,pendingRequests:ge.a.number.isRequired,fetch:ge.a.func.isRequired,requestAccess:ge.a.func.isRequired,reset:ge.a.func.isRequired,showCreateRoom:ge.a.func.isRequired,showUsers:ge.a.func.isRequired,updateImage:ge.a.func.isRequired};var pt=Object(u.connect)(function(e){var n=e.org,t=n.hasLoaded,o=n.id,a=n.isActive,r=n.isAdmin,i=n.isUser,c=n.name,u=n.pendingRequests;return{hasLoaded:t,id:o,isActive:a,isAdmin:r,isAuth:e.user.isAuth,isUser:i,name:c,pendingRequests:u}},{fetch:function(e){return{type:"ORG/FETCH",payload:H.fetch({endpoint:"org/".concat(e)})}},requestAccess:function(){return function(e,n){var t=n().org.id;return e({type:"ORG/REQUEST_ACCESS",payload:H.fetch({endpoint:"org/".concat(t,"/users"),method:"PUT"})})}},reset:function(){return{type:C}},showCreateRoom:function(){return{type:P}},showUsers:function(){return{type:A}},updateImage:function(e){var a=e.image,r=e.blob;return function(e,n){var t=n().org.id,o=new FormData;return o.append("image",r),e({type:"ORG/UPDATE_IMAGE",payload:H.fetch({body:o,endpoint:"org/".concat(t,"/").concat(a),method:"POST"})})}}})(dt),mt=t("fWck");function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],o=!0,a=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function gt(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bt(e,n){return(bt=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var wt=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=yt(a).call(this,e))||"object"!==ft(o)&&"function"!=typeof o?vt(t):o).dom=f.a.createRef(),n.onDrop=n.onDrop.bind(vt(n)),n.onPointerWheel=n.onPointerWheel.bind(vt(n)),n.onResize=n.onResize.bind(vt(n)),n.origin={x:0,y:0},n.scale=1,n.peers={},n.photos={},n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&bt(e,n)}(a,r["Component"]),n=a,o=[{key:"onDragOver",value:function(e){e.preventDefault()}}],(t=[{key:"componentDidMount",value:function(){var e=this.dom.current;this.loadPhotos(this.props),e.addEventListener("dragover",a.onDragOver,!1),e.addEventListener("drop",this.onDrop,!1),window.addEventListener("resize",this.onResize,!1),this.touches=ee()(window,{filtered:!0,preventSimulated:!1}).on("start",this.onPointerStart.bind(this)).on("move",this.onPointerMove.bind(this)).on("end",this.onPointerEnd.bind(this)),Object(mt.addWheelListener)(window,this.onPointerWheel),this.onResize()}},{key:"componentWillReceiveProps",value:function(e){this.loadPhotos(e),this.draw(e)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){var e=this.dom.current;this.touches.disable(),e.removeEventListener("dragover",a.onDragOver),e.removeEventListener("drop",this.onDrop),Object(mt.removeWheelListener)(window,this.onPointerWheel),window.removeEventListener("resize",this.onResize)}},{key:"onDrop",value:function(e){var n=this.props.socket,t=e.clientX,o=e.clientY,a=ht(e.dataTransfer.files,1)[0];if(e.preventDefault(),a){var r=this.getPointer([t,o]),i=new FileReader;i.onload=function(){n.send(JSON.stringify({type:"ROOM/ADD_PHOTO",payload:{origin:r,photo:i.result.substr(i.result.indexOf("base64")+7)}}))},i.readAsDataURL(a)}}},{key:"onPointerStart",value:function(e,n){var i=this,t=this.props,o=t.photos,a=t.socket,r=e.button||0,c=this.getPointer(n),u=c.x,s=c.y,l=o.filter(function(e){var n=e._id,t=e.origin,o=i.photos[n];if(!o)return!1;var a=o.width,r=o.height;return!(u<t.x||u>t.x+a||s<t.y||s>t.y+r)});l.reverse();var d=l[0];0===r&&!d||2===r?this.dragging={canvas:n}:0===r&&d&&(e.shiftKey?a.send(JSON.stringify({type:"ROOM/REMOVE_PHOTO",payload:{photo:d._id}})):this.dragging={offset:{x:d.origin.x-u,y:d.origin.y-s},photo:d})}},{key:"onPointerMove",value:function(e,n){var t=this.dragging,o=this.origin,a=this.scale,r=this.props.peers,i=this.getPointer(n),c=i.x,u=i.y;if(r.forEach(function(e){var n=e.connection;n._channel&&"open"===n._channel.readyState&&n.send(new Int32Array([c,u]))}),t){if(t.canvas&&(o.x+=(n[0]-t.canvas[0])/a,o.y+=(n[1]-t.canvas[1])/a,t.canvas=n),t.photo){var s=t.offset,l=t.photo;l.origin.x=c+s.x,l.origin.y=u+s.y}this.draw()}}},{key:"onPointerEnd",value:function(){var e=this.dragging,n=this.props.socket;if(e&&(delete this.dragging,e.photo)){var t=e.photo,o=t._id,a=t.origin;n.send(JSON.stringify({type:"ROOM/MOVE_PHOTO",payload:{origin:a,photo:o}}))}}},{key:"onPointerWheel",value:function(e){var n=e.deltaY,t=1+.075*Math.min(Math.max(-n,-1),1);this.scale*=t,this.scale=Math.min(Math.max(this.scale,.25),2),this.draw()}},{key:"onResize",value:function(){var e=this.dom.current;e.width=window.innerWidth,e.height=window.innerHeight,this.draw()}},{key:"getPointer",value:function(e){var n=ht(e,2),t=n[0],o=n[1],a=this.dom.current,r=this.origin,i=this.scale;return{x:Math.round((t-.5*a.width)/i-r.x),y:Math.round((o-.5*a.height)/i-r.y)}}},{key:"loadPhotos",value:function(e){var a=this,n=e.peers,t=e.photos;n.forEach(function(e){var n=e._id;if(!a.peers[n]){var t=new Image;t.src="".concat(H.baseURL,"user/").concat(n,"/photo?auth=").concat(H.token),t.onload=function(){return a.draw()},a.peers[n]=t}}),t.forEach(function(e){var n=e._id,t=e.photo;if(!a.photos[n]){var o=new Image;o.src="data:image/jpeg;base64,".concat(t),o.onload=function(){return a.draw()},a.photos[n]=o}})}},{key:"draw",value:function(e){var c=this,n=this.dom.current,t=this.origin,u=this.scale,o=e||this.props,a=o.name,r=o.peers,i=o.photos,s=n.getContext("2d");n.width=n.width,s.translate(.5*n.width,.5*n.height),s.scale(u,u),s.translate(t.x,t.y),s.textAlign="center",s.textBaseline="middle",s.fillStyle="#999",s.font="32px Arial",s.fillText(h.I18n.t("Room.".concat(a?"welcome":"joining"),{name:a}),0,0),i.forEach(function(e){var n=e._id,t=e.origin;c.photos[n]&&s.drawImage(c.photos[n],t.x,t.y)}),r.forEach(function(e){var n=e._id,t=e.pointer;if(c.peers[n]&&t){var o=ht(t,2),a=o[0],r=o[1],i=24/u;s.beginPath(),s.arc(a,r,i,0,2*Math.PI),s.fill(),s.save(),s.beginPath(),s.arc(a,r,.9*i,0,2*Math.PI),s.clip(),s.drawImage(c.peers[n],a-i,r-i,2*i,2*i),s.restore()}})}},{key:"render",value:function(){var e=this.dom;return f.a.createElement("canvas",{ref:e})}}])&&gt(n.prototype,t),o&&gt(n,o),a}();wt.propTypes={name:ge.a.string.isRequired,peers:ge.a.arrayOf(ge.a.shape({_id:ge.a.string.isRequired,connection:ge.a.object.isRequired,pointer:ge.a.arrayOf(ge.a.number)})).isRequired,photos:ge.a.arrayOf(ge.a.shape({origin:ge.a.shape({x:ge.a.number.isRequired,y:ge.a.number.isRequired}),photo:ge.a.string.isRequired})).isRequired,socket:ge.a.oneOfType([ge.a.bool,ge.a.object]).isRequired};var Et=Object(u.connect)(function(e){var n=e.room;return{name:n.name,peers:n.peers,photos:n.photos,socket:n.socket}})(wt),Ot=t("9C/b"),St=t("TX9C"),Rt=t("BRrH"),kt=t.n(Rt);function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Tt(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(e){jt(n,e,t[e])})}return n}function jt(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ct(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Pt(e){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function At(e,n){return(At=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var qt=function(e){function a(e){var n,t,o;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),t=this,(n=!(o=Pt(a).call(this,e))||"object"!==_t(o)&&"function"!=typeof o?xt(t):o).onMessage=n.onMessage.bind(xt(n)),n}var n,t,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&At(e,n)}(a,r["Component"]),n=a,(t=[{key:"componentWillMount",value:function(){var e=this.props,n=e.match.params,t=n.org,o=n.slug,a=e.settings,r=a.audioInput,i=a.videoInput,c=e.startStream;this.connectToServer({org:t,slug:o}),navigator.mediaDevices.getUserMedia({audio:!r||{deviceId:{exact:r}},video:Tt({width:640,height:640},i?{deviceId:{exact:i}}:{facingMode:"user"})}).then(c).catch(function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(c).catch(function(){})})}},{key:"componentWillReceiveProps",value:function(e){var n=e.match.params,t=n.org,o=n.slug,a=this.props,r=a.match.params,i=r.org,c=r.slug,u=a.reset;i===t&&c===o||(u(),this.connectToServer({org:t,slug:o}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){var e=this.socket,n=this.props,t=n.hideLoading,o=n.reset;e.readyState===St.a.CONNECTING&&t(),e.close(1e3),o()}},{key:"onMessage",value:function(e){var n,t=this,o=e.data,a=this.socket,r=this.props,i=r.match.params.org,c=r.addPhoto,u=r.history,s=r.join,l=r.movePhoto,d=r.peerJoin,p=r.peerLeave,m=r.peerSignal,f=r.removePhoto;try{n=JSON.parse(o)}catch(e){return}switch(n.type){case q:c(n.payload);break;case D:l(n.payload);break;case F:f(n.payload);break;case L:s(Tt({},n.payload,{peers:n.payload.peers.map(function(e){return t.connectToPeer(e,!0)}),socket:a}));break;case N:d(this.connectToPeer(n.payload));break;case M:p(n.payload);break;case z:m(n.payload);break;case"ROOM/ERROR":u.replace("FULL_ROOM"===n.payload?"/".concat(i):"/404")}}},{key:"connectToServer",value:function(e){var n=this,t=e.org,o=e.slug,a=this.props,r=a.hideLoading,i=a.showLoading;this.socket&&(this.socket.readyState===St.a.CONNECTING&&r(),this.socket.close(1e3)),i(),this.socket=new St.a("".concat(H.baseURL.replace(/http/,"ws"),"org/").concat(t,"/room/").concat(o),H.token),this.socket.onopen=function(){n.socket.onclose=null,n.socket.onerror=null,r()},this.socket.onmessage=this.onMessage}},{key:"connectToPeer",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.socket,o=this.props,a=o.stream,r=o.peerPointer,i=o.peerStream;return t.connection=new kt.a({initiator:e,stream:a}),t.connection.on("signal",function(e){n.send(JSON.stringify({type:"ROOM/PEER_SIGNAL",payload:{peer:t.peer,signal:e}}))}),t.connection.on("data",function(e){var n=e.buffer;return r({peer:t.peer,pointer:It(new Int32Array(n))})}),t.connection.on("stream",function(e){return i({peer:t.peer,stream:e})}),t}},{key:"render",value:function(){return null}}])&&Ct(n.prototype,t),o&&Ct(n,o),a}();qt.propTypes={history:ge.a.object.isRequired,match:ge.a.shape({params:ge.a.shape({org:ge.a.string.isRequired,slug:ge.a.string.isRequired}).isRequired}).isRequired,settings:ge.a.shape({audioInput:ge.a.string.isRequired,videoInput:ge.a.string.isRequired}).isRequired,stream:ge.a.oneOfType([ge.a.bool,ge.a.object]).isRequired,addPhoto:ge.a.func.isRequired,hideLoading:ge.a.func.isRequired,join:ge.a.func.isRequired,movePhoto:ge.a.func.isRequired,removePhoto:ge.a.func.isRequired,reset:ge.a.func.isRequired,peerJoin:ge.a.func.isRequired,peerLeave:ge.a.func.isRequired,peerPointer:ge.a.func.isRequired,peerSignal:ge.a.func.isRequired,peerStream:ge.a.func.isRequired,showLoading:ge.a.func.isRequired,startStream:ge.a.func.isRequired};var Lt=Object(Ot.a)(Object(u.connect)(function(e){var n=e.user;return{settings:n.settings,stream:n.stream}},{addPhoto:function(e){var n=e._id,t=e.origin,o=e.photo;return{type:q,payload:{_id:n,origin:t,photo:o}}},hideLoading:s.hideLoading,join:function(e){var n=e.name,t=e.peers,o=e.photos,a=e.socket;return{type:L,payload:{name:n,peers:t,photos:o,socket:a}}},movePhoto:function(e){var n=e.origin,t=e.photo;return{type:D,payload:{origin:n,photo:t}}},removePhoto:function(e){var n=e.photo;return{type:F,payload:{photo:n}}},reset:function(){return{type:W}},peerJoin:function(e){return{type:N,payload:{peer:e}}},peerLeave:function(e){var n=e.peer;return{type:M,payload:{peer:n}}},peerPointer:function(e){var n=e.peer,t=e.pointer;return{type:U,payload:{peer:n,pointer:t}}},peerSignal:function(e){var n=e.peer,t=e.signal;return{type:z,payload:{peer:n,signal:t}}},peerStream:function(e){var n=e.peer,t=e.stream;return{type:G,payload:{peer:n,stream:t}}},showLoading:s.showLoading,startStream:function(t){return function(e,n){n().user.isAudioMuted&&t.getAudioTracks().forEach(function(e){e.enabled=!1}),e({type:E,payload:{stream:t}})}}})(qt)),Nt=ye.a.div.withConfig({displayName:"peers__Listing",componentId:"j59ndp-0"})(["position:absolute;top:100px;right:0;> img,> div > video{display:block;background:#000;width:100px;height:100px;vertical-align:middle;box-shadow:0 0 10px rgba(0,0,0,.5);}"]),Mt=function(e){var n=e.peers;return f.a.createElement(Nt,null,n.map(function(e){var n=e._id,t=e.peer,o=e.video;return o&&o.srcObject.getVideoTracks().length?f.a.createElement(ke,{key:t,video:o}):f.a.createElement("img",{key:t,src:"".concat(H.baseURL,"user/").concat(n,"/photo?auth=").concat(H.token)})}))};Mt.propTypes={peers:ge.a.arrayOf(ge.a.shape({_id:ge.a.string.isRequired,peer:ge.a.string.isRequired,video:ge.a.object})).isRequired};var Ut=Object(u.connect)(function(e){return{peers:e.room.peers}})(Mt),zt=function(){return f.a.createElement("div",null,f.a.createElement(Et,null),f.a.createElement(Lt,null),f.a.createElement(Ut,null))};function Gt(){return(Gt=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Dt(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],0<=n.indexOf(t)||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],0<=n.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var Ft,Wt,Bt,Ht,Vt=Object(u.connect)(function(e){return{isAuth:e.user.isAuth}})(function(e){var n=e.component,t=e.isAuth,o=e.requiresAuth,a=e.requiresNoAuth,r=Dt(e,["component","isAuth","requiresAuth","requiresNoAuth"]),i=o&&!t||a&&t;return f.a.createElement(pe.a,Gt({},r,{render:function(e){return i?f.a.createElement(me.a,{to:"/"}):f.a.createElement(n,e)}}))}),Jt=function(){return f.a.createElement(Je,null,f.a.createElement(fe.a,null,f.a.createElement(Vt,{exact:!0,path:"/",component:vn}),f.a.createElement(Vt,{exact:!0,path:"/404",component:Sn}),f.a.createElement(Vt,{exact:!0,path:"/:org/:slug",component:zt,requiresAuth:!0}),f.a.createElement(Vt,{exact:!0,path:"/:slug",component:pt}),f.a.createElement(Vt,{path:"*",component:Sn})))},Kt=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,i.d),Yt=Object(i.e)(de,{},Kt(Object(i.a)(p.a,c.a,Object(s.loadingBarMiddleware)())));Ft=Yt,Wt=localStorage.getItem("BABELCHAT::LOCALE"),Bt=((window.navigator.languages?window.navigator.languages[0]:null)||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage||"en").substr(0,2).toLowerCase(),Ht="en",~Y.indexOf(Wt)?Ht=Wt:~Y.indexOf(Bt)&&(Ht=Bt),Object(h.syncTranslationWithStore)(Ft),Ft.dispatch(Object(h.loadTranslations)(Q)),Ft.dispatch(Object(h.setLocale)(Ht)),Yt.getState().user.isAuth&&Yt.dispatch(V());var Qt=Object(o.a)({basename:"/"}),Xt=document.getElementById("mount");Object(a.render)(f.a.createElement(u.Provider,{store:Yt},f.a.createElement(d.a,{history:Qt},f.a.createElement(Jt,null))),Xt),window.addEventListener("contextmenu",function(e){return e.preventDefault()},!1)},p2bk:function(e,n,t){}},[[0,1,2]]]);
//# sourceMappingURL=main.866cfc2ac3bdd7931d77c7de07f17a8b.js.map